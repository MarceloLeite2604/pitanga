{"version":3,"sources":["config.js","shared/model/events/index.ts","shared/model/events/CheckRoomExists.ts","shared/model/events/CreateRoom.ts","shared/model/events/JoinUser.ts","shared/model/events/AttendeeVoted.ts","shared/model/events/RevealVotes.ts","shared/model/events/ResetRoom.ts","shared/model/events/AttendeeLeftRoom.ts","shared/model/Attendee.ts","shared/model/ChartPoint.ts","shared/model/Vote.ts","shared/model/VotingStatus.ts","shared/model/Toast.ts","app/hooks/useWebSocketSubjects.ts","shared/model/events/EventType.ts","theme-controller/ThemeController.tsx","theme-controller/hooks/useTheme.ts","app/container/BoxMargin.tsx","app/container/hooks/useStyles.ts","app/container/Container.tsx","app/home/GridItem.tsx","app/home/hooks/useStyles.tsx","app/home/Home.tsx","app/hooks/events-callback/useEventsCallback.ts","app/hooks/events-callback/useAttendeeVotedCallback.ts","app/hooks/events-callback/useRoomCreatedCallback.ts","app/hooks/events-callback/useUserCreatedCallback.ts","app/hooks/events-callback/useCheckRoomExistsCallback.ts","app/hooks/events-callback/useMaxUsersReachedCallback.ts","app/hooks/events-callback/useUserJoinedCallback.ts","app/hooks/events-callback/useUserDroppedCallback.ts","app/hooks/events-callback/useRevealVotesCallback.ts","app/hooks/events-callback/useResetRoomCallback.ts","app/hooks/events-callback/useAttendeeLeftRoomCallback.ts","app/hooks/useSubscriptions.ts","app/hooks/useWebSocketCallbacks.ts","shared/hooks/useUpdateState.tsx","app/room/attendees/attendee/slider/hooks/useStyles.ts","app/room/attendees/attendee/slider/Slider.tsx","app/room/attendees/attendee/hooks/useStyles.ts","app/room/attendees/attendee/Attendee.tsx","app/room/attendees/Attendees.tsx","app/room/controls/Controls.tsx","app/room/controls/hooks/useButtonsCallback.ts","app/room/effort-value-chart/hooks/useOnMouseMoveCallback.ts","shared/hooks/useThrottledState.tsx","app/room/effort-value-chart/hooks/useStyles.tsx","app/room/effort-value-chart/constants.ts","app/room/effort-value-chart/TooltipRenderer.tsx","app/room/effort-value-chart/VotesLabel.tsx","app/room/effort-value-chart/EffortValueChart.tsx","app/room/effort-value-chart/hooks/usePoints.ts","app/room/effort-value-chart/hooks/useOnClickCallback.ts","app/room/effort-value-chart/hooks/useCreateMeanPoint.ts","app/room/Room.tsx","app/room/hooks/useEventsCallback.ts","app/Title.tsx","app/App.tsx","app/hooks/useStateData.ts","app/hooks/useCheckAttendeeLeftRoomCallback.ts","index.tsx","shared/model/index.ts"],"names":["config","host","port","path","buildCheckRoomExists","room","type","EventType","CheckRoomExists","payload","buildCreateRoomEvent","user","CreateRoom","buildJoinUserEvent","JoinUser","buildAttendeeVotedEvent","attendee","AttendeeVoted","buildRevealVotesEvent","RevealVotes","buildResetRoomEvent","ResetRoom","buildAttendeeLeftRoomEvent","AttendeeLeftRoom","sortByJoinedAtWithCurrentUserFirst","attendees","sort","first","second","id","joinedAt","removeAttendeeFromAttendees","length","filter","att","removeUserFromAttendees","retrieveAttendeeForUser","createChartPoint","effort","vote","value","label","icon","roundChartPoint","x","y","Math","round","createVote","VotingStatus","ToastType","createClient","webSocketSubjects","client","W3CWebSocket","schema","location","protocol","configuration","elaborateWebsocketUri","onopen","$connected","next","onclose","onmessage","message","data","Buffer","ArrayBuffer","Error","JSON","parse","$in","useWebSocketSubjects","useState","Subject","$out","$toast","useEffect","subscribe","event","console","log","send","stringify","ThemeController","darkMode","children","prefersDarkMode","useMediaQuery","theme","useMemo","createMuiTheme","palette","primary","main","secondary","ThemeProvider","CssBaseline","BoxMargin","Box","component","Grid","display","md","xs","useStyles","makeStyles","createStyles","container","padding","Container","styles","alignItems","justify","spacing","className","item","GridItem","direction","joinRooomButton","marginTop","Home","connected","subjects","roomNumber","setRoomNumber","history","useHistory","joinRoom","useCallback","push","validateRoomNumber","roomNum","isNaN","parseInt","classes","joinRoomButtonDisabled","style","flexGrow","TextField","inputProps","maxLength","onChange","target","Button","variant","color","disabled","onClick","Typography","useEventsCallback","params","attendeeVotedCallback","setData","previousState","votingStatus","useAttendeeVotedCallback","roomCreatedCallback","useRoomCreatedCallback","userCreatedCallback","useUserCreatedCallback","checkRoomExistsCallback","exists","undefined","useCheckRoomExistsCallback","maxUsersReachedCallback","useMaxUsersReachedCallback","userJoinedCallback","roomAttendee","find","useUserJoinedCallback","userDroppedCallback","droppedAttendee","remainingAttendees","toast","INFORMATION","newRoomOwner","roomOwner","useUserDroppedCallback","revealVotesCallback","Closed","useRevealVotesCallback","resetRoomCallback","useResetRoomCallback","attendeeLeftRoomEventCallback","useAttendeeLeftRoomCallback","callbacks","UserCreated","RoomCreated","UserDropped","UserJoined","MaxUsersReached","callback","toastOptions","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","useSubscriptions","subscriptions","setSubscriptions","connectionCallback","WARNING","ERROR","useWebSocketCallbacks","eventsCallback","toastsCallback","showToast","info","error","warn","events","unsubscribe","connection","toasts","useUpdateState","deps","updateState","muiSlider","typography","fontSize","muiSliderGridItem","Slider","hide","align","marks","min","max","defaultValue","String","attendeeCard","flexDirection","justifyContent","attendeeCardContent","minHeight","paddingBottom","currentUser","background","dark","currentUserVoted","lighten","otherUserVoted","paper","iconTypography","Attendee","hideSlider","Open","cardClassName","Card","CardContent","alignContent","Attendees","map","index","Controls","onResetButtonClick","onRevealButtonClick","useButtonsCallback","noVotes","useOnMouseMoveCallback","initialState","fps","leading","state","unthrottledSetState","useThrottleCallback","useThrottledState","suggestedPoint","setSuggestedPoint","props","xValue","yValue","responsiveContainer","borderRadius","grey","domainValues","mediumPoint","domainLimits","axisTicks","Array","from","_","TooltipRenderer","active","points","hoveredPoint","hoveredLabels","point","itemsPerLine","sqrt","tooltipContent","reduce","acc","backgroundColor","letterSpacing","whiteSpace","VotesLabel","width","height","fill","textAnchor","dominantBaseline","EffortValueChart","useTheme","usePoints","onMouseMoveCallback","onClickCallback","useOnClickCallback","createMeanPoint","mean","ResponsiveContainer","aspect","ScatterChart","margin","top","bottom","left","right","onMouseMove","XAxis","dataKey","axisLine","ticks","domain","stroke","YAxis","ReferenceLine","strokeWidth","CartesianGrid","strokeDasharray","Scatter","isAnimationActive","strokeOpacity","LabelList","content","shape","rotate","fillOpacity","Tooltip","Room","eventsSubscription","setEventsSubscription","roomId","useParams","userAttendee","Title","textDecoration","textShadow","App","dataState","useDataState","checkAttendeeLeftRoomCallback","pathname","match","RegExp","unregisterCallbackControl","setUnregisterCallbackControl","every","element","listen","useCheckAttendeeLeftRoomCallback","render","document","getElementById"],"mappings":"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","file":"static/js/main.966c2173.chunk.js","sourcesContent":["const local = {\n  host: 'localhost',\n  port: 8080,\n  path: '/pitanga'\n};\n\nconst production = {\n  host: 'marceloleite2604-pitanga.herokuapp.com',\n  port: 80,\n  path: '/pitanga'\n};\n\nconst config = process.env.REACT_APP_STAGE === 'production' ? production : local;\n\nexport default {\n  ...config\n};\n","export * from './Event';\nexport * from './EventType';\nexport * from './CheckRoomExists';\nexport * from './CreateRoom';\nexport * from './CreateUser';\nexport * from './JoinUser';\nexport * from './MaxRoomsReached';\nexport * from './MaxRoomUsersReached';\nexport * from './MaxUsersReached';\nexport * from './RoomCreated';\nexport * from './UserCreated';\nexport * from './UserDropped';\nexport * from './UserJoined';\nexport * from './AttendeeVoted';\nexport * from './RevealVotes';\nexport * from './ResetRoom';\nexport * from './AttendeeLeftRoom';\n","import { Room } from '..';\nimport { Event } from './Event';\nimport { EventType } from './EventType';\n\nexport interface CheckRoomExistsPayload {\n  room: Room,\n  exists?: boolean\n}\n\nexport interface CheckRoomExistsEvent extends Event<EventType.CheckRoomExists, CheckRoomExistsPayload> { }\n\nexport function buildCheckRoomExists(room: Room) {\n  return {\n    type: EventType.CheckRoomExists,\n    payload: {\n      room\n    }\n  } as CheckRoomExistsEvent;\n}\n","import { User } from '..';\nimport { Event } from './Event';\nimport { EventType } from './EventType';\n\nexport interface CreateRoomPayload {\n  user: User\n}\n\nexport interface CreateRoomEvent extends Event<EventType.CreateRoom, CreateRoomPayload> { }\n\nexport function buildCreateRoomEvent(user: User) {\n  return {\n    type: EventType.CreateRoom,\n    payload: {\n      user\n    }\n  } as CreateRoomEvent;\n}\n","import { User, Room } from '..';\nimport { Event } from './Event';\nimport { EventType } from './EventType';\n\nexport interface JoinUserPayload {\n  room: Room,\n  user: User\n}\n\nexport interface JoinUserEvent extends Event<EventType.JoinUser, JoinUserPayload> { }\n\nexport function buildJoinUserEvent(user: User, room: Room) {\n  return {\n    type: EventType.JoinUser,\n    payload: {\n      user,\n      room\n    }\n  } as JoinUserEvent;\n}\n","import { Attendee } from '..';\nimport { VotingStatus } from '../VotingStatus';\nimport { Event } from './Event';\nimport { EventType } from './EventType';\n\nexport interface AttendeeVotedPayload {\n  attendee: Attendee,\n  votingStatus: VotingStatus\n}\n\nexport interface AttendeeVotedEvent extends Event<EventType.AttendeeVoted, AttendeeVotedPayload> { }\n\nexport function buildAttendeeVotedEvent(attendee: Attendee) {\n  return {\n    type: EventType.AttendeeVoted,\n    payload: {\n      attendee\n    }\n  } as AttendeeVotedEvent;\n}\n","import { Event } from './Event';\nimport { EventType } from './EventType';\n\nexport interface RevealVotesEvent extends Event<EventType.RevealVotes> { }\n\nexport function buildRevealVotesEvent() {\n  return {\n    type: EventType.RevealVotes\n  } as RevealVotesEvent;\n}\n","import { Room } from '../Room';\nimport { Event } from './Event';\nimport { EventType } from './EventType';\n\nexport interface ResetRoomPayload {\n  room: Room\n}\n\nexport interface ResetRoomEvent extends Event<EventType.ResetRoom, ResetRoomPayload> {\n}\n\nexport function buildResetRoomEvent() {\n  return {\n    type: EventType.ResetRoom\n  } as ResetRoomEvent;\n}\n","import { Attendee } from '../';\nimport { Event } from './Event';\nimport { EventType } from './EventType';\n\nexport interface AttendeeLeftRoomPayload {\n  attendee: Attendee,\n  newRoomOwner?: Attendee\n}\n\nexport interface AttendeeLeftRoomEvent extends Event<EventType.AttendeeLeftRoom, AttendeeLeftRoomPayload> { }\n\nexport function buildAttendeeLeftRoomEvent(attendee: Attendee) {\n  return {\n    type: EventType.AttendeeLeftRoom,\n    payload: {\n      attendee\n    }\n  } as AttendeeLeftRoomEvent;\n}\n","import { ChartPoint } from './ChartPoint';\nimport { User } from './User';\nimport { Vote } from './Vote';\n\nexport interface Attendee {\n  user: User,\n  icon: string,\n  joinedAt: number,\n  roomOwner: boolean\n  vote?: Vote\n}\n\nexport const sortByJoinedAtWithCurrentUserFirst = (attendees: Attendee[], user: User) => {\n  return attendees.sort((first, second) => {\n    if (first.user.id === user.id) {\n      return -1;\n    }\n\n    if (second.user.id === user.id) {\n      return 1;\n    }\n\n    return first.joinedAt - second.joinedAt;\n  });\n};\n\nexport const removeAttendeeFromAttendees = (attendee: Attendee, attendees: Attendee[]) => {\n  if (attendees.length === 0 || !attendee) {\n    return attendees;\n  }\n\n  return attendees.filter(att => att.user.id !== attendee.user.id);\n};\n\nexport const removeUserFromAttendees = (user: User, attendees: Attendee[]) => {\n  if (attendees.length === 0 || !user) {\n    return attendees;\n  }\n\n  return attendees.filter(attendee => attendee.user.id !== user.id);\n};\n\nexport const retrieveAttendeeForUser = (attendees: Attendee[], user: User) => {\n  if (attendees.length === 0 || !user) {\n    return undefined;\n  }\n\n  return attendees.filter(attendee => attendee.user.id === user.id)[0];\n};\n\nexport const createChartPoint = (attendee: Attendee) => {\n  return {\n    effort: attendee.vote?.effort,\n    value: attendee.vote?.value,\n    label: attendee.icon\n  } as ChartPoint;\n};\n","export interface ChartPoint {\n  value: number,\n  effort: number,\n  label: string\n}\n\nexport const roundChartPoint = (x: number, y: number, label?: string) => {\n  return {\n    value: Math.round(x),\n    effort: Math.round(y),\n    label\n  } as ChartPoint;\n};\n","export interface Vote {\n  effort: number,\n  value: number\n};\n\nexport const createVote = (x: number, y: number) => {\n  return {\n    value: Math.round(x),\n    effort: Math.round(y)\n  } as Vote;\n};\n","export enum VotingStatus {\n  Open = 'open',\n  Closed = 'closed'\n}\n","export enum ToastType {\n  INFORMATION = 'info',\n  SUCCESS = 'success',\n  WARNING = 'warn',\n  ERROR = 'error'\n}\n\nexport interface Toast {\n  message: string,\n  type?: ToastType\n}\n","import { useEffect, useState } from 'react';\nimport { Subject } from 'rxjs';\nimport { w3cwebsocket as W3CWebSocket } from 'websocket';\nimport configuration from '../../config';\nimport { Event, WebSocketSubjects, Toast } from '../../shared/model';\n\nfunction elaborateWebsocketUri() {\n  const schema = location.protocol === 'https:' ? 'wss:' : 'ws:';\n  return `${schema}//${configuration.host}:${configuration.port}${configuration.path}`;\n}\n\nfunction createClient(webSocketSubjects: WebSocketSubjects) {\n  const client = new W3CWebSocket(elaborateWebsocketUri());\n  client.onopen = () => {\n    webSocketSubjects.$connected.next(true);\n  };\n\n  client.onclose = () => {\n    webSocketSubjects.$connected.next(false);\n  };\n\n  client.onmessage = (message) => {\n    if (message.data instanceof Buffer || message.data instanceof ArrayBuffer) {\n      throw new Error('Unsuported message data type.');\n    }\n\n    const data = JSON.parse(message.data) as Event;\n    webSocketSubjects.$in.next(data);\n  };\n\n  return client;\n}\n\nexport const useWebSocketSubjects = () => {\n\n  const [webSocketSubjects] = useState<WebSocketSubjects>({\n    $connected: new Subject<boolean>(),\n    $in: new Subject<Event>(),\n    $out: new Subject<Event>(),\n    $toast: new Subject<Toast>()\n  });\n\n  const [client] = useState(() => createClient(webSocketSubjects));\n\n  useEffect(() => {\n    webSocketSubjects.$out.subscribe(event => {\n      console.log(`Sending event \"${event.type}\"`);\n      client.send(JSON.stringify(event));\n    });\n  }, []);\n\n  return webSocketSubjects;\n};\n","export enum EventType {\n  CreateUser = 'create-user',\n  UserCreated = 'user-created',\n  MaxUsersReached = 'max-users-reached',\n  JoinUser = 'join-user',\n  UserJoined = 'user-joined',\n  MaxRoomUsersReached = 'max-room-users-reached',\n  CreateRoom = 'create-room',\n  RoomCreated = 'room-created',\n  MaxRoomsReached = 'max-rooms-reached',\n  CheckRoomExists = 'check-room-exists',\n  UserDropped = 'user-dropped',\n  AttendeeVoted = 'attendee-voted',\n  ResetRoom = 'reset-room',\n  RevealVotes = 'reveal-votes',\n  AttendeeLeftRoom = 'attendee-left-room'\n}\n","import { FC } from 'react';\nimport { ThemeProvider, useMediaQuery, CssBaseline } from '@material-ui/core';\nimport { useTheme } from './hooks';\n\nexport const ThemeController: FC = ({ children }) => {\n  const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)');\n  const theme = useTheme(prefersDarkMode);\n\n  return (\n    <ThemeProvider theme={theme}>\n      <CssBaseline />\n      {children}\n    </ThemeProvider>\n  );\n};\n","import { useMemo } from 'react';\nimport { createMuiTheme } from '@material-ui/core';\n\nexport const useTheme = (darkMode: boolean) => {\n  return useMemo(() => createMuiTheme({\n    palette: {\n      type: darkMode ? 'dark' : 'light',\n      primary: {\n        main: '#9fdc93'\n      },\n      secondary: {\n        main: '#C0A287'\n      }\n    }\n  }), [darkMode]);\n};\n","import { Box, Grid } from '@material-ui/core';\n\nexport const BoxMargin = () =>\n  <Box\n    component={Grid}\n    display={{\n      md: 'block',\n      xs: 'none'\n    }} />;\n","import { createStyles, makeStyles } from '@material-ui/styles';\n\nexport const useStyles = makeStyles(createStyles({\n  container: {\n    padding: '2vh 2vw'\n  }\n}));\n","import { Grid } from '@material-ui/core';\nimport { FC } from 'react';\nimport { BoxMargin } from './BoxMargin';\nimport { useStyles } from './hooks';\n\nexport const Container: FC = ({ children }) => {\n\n  const styles = useStyles();\n\n  return <Grid\n    container\n    alignItems='center'\n    justify='center'\n    spacing={0}\n    className={styles.container} >\n    <BoxMargin />\n    <Grid\n      item\n      md={10}\n      xs={12}>\n      {children}\n    </Grid>\n    <BoxMargin />\n  </Grid >;\n};\n","import { FC } from 'react';\nimport { Grid, GridSize, GridItemsAlignment } from '@material-ui/core';\n\ninterface Params {\n  xs?: boolean | GridSize,\n  alignItems?: GridItemsAlignment\n}\n\nexport const GridItem : FC<Params> = ({ xs, alignItems, children }) => {\n\n  return (\n    <Grid\n      container\n      item\n      xs={xs}\n      direction='column'\n      justify='flex-start'\n      alignItems={alignItems || 'center'}>\n      {children}\n    </Grid>\n  );\n};\n","import { createStyles, makeStyles } from '@material-ui/styles';\n\nexport const useStyles = makeStyles(createStyles({\n  joinRooomButton: {\n    marginTop: '16px'\n  }\n}));\n","import { useCallback, useState } from 'react';\nimport { useHistory } from 'react-router';\nimport { Button, TextField, Grid, Typography } from '@material-ui/core';\nimport { buildCreateRoomEvent, Data } from '../../shared/model';\nimport { GridItem } from './GridItem';\nimport { useStyles } from './hooks';\n\ninterface Params {\n  data: Data\n}\n\nexport const Home = ({ data }: Params) => {\n\n  const { connected, user, subjects } = data;\n  const [roomNumber, setRoomNumber] = useState<string>();\n\n  const history = useHistory();\n  \n  const joinRoom = useCallback(() => {\n    history.push(`${roomNumber}`);\n  }, [history, roomNumber]);\n\n  const sendCreateRoomEvent = () => {\n    user && subjects.$out.next(buildCreateRoomEvent(user));\n  };\n\n  const validateRoomNumber = useCallback((roomNum?: string) => {\n\n    if (!roomNum) {\n      return false;\n    }\n\n    if (roomNum.length !== 8) {\n      return false;\n    }\n\n    if (isNaN(parseInt(roomNum))) {\n      return false;\n    }\n\n    return true;\n  }, []);\n\n  const classes = useStyles();\n\n  const joinRoomButtonDisabled = !connected || !user || !validateRoomNumber(roomNumber);\n\n  return (\n    <Grid\n      container\n      spacing={2}\n      alignItems='center'\n      style={{ flexGrow: 0 }}>\n      <GridItem\n        xs={6}\n        alignItems='flex-end'>\n        <TextField\n          id='roomNumber'\n          label='Room number'\n          inputProps={{\n            maxLength: '8'\n          }}\n          onChange={event => setRoomNumber(event.target.value)} />\n      </GridItem>\n      <GridItem\n        xs={6}\n        alignItems='flex-start'>\n        <Button\n          variant='contained'\n          color='primary'\n          disabled={joinRoomButtonDisabled}\n          onClick={joinRoom}\n          className={classes.joinRooomButton}>Join Room</Button>\n      </GridItem>\n      <GridItem xs={12}>\n        <Typography>Or</Typography>\n      </GridItem>\n      <GridItem xs={12}>\n        <Button\n          variant='contained'\n          color='primary'\n          disabled={!connected || !user}\n          onClick={sendCreateRoomEvent}>Create room</Button>\n      </GridItem>\n    </Grid >\n  );\n};\n","import { useCallback, useMemo } from 'react';\nimport { EventType, Event } from '../../../shared/model';\nimport { CallbackHookParams, EventCallback } from '../types';\nimport { useAttendeeVotedCallback } from './useAttendeeVotedCallback';\nimport { useRoomCreatedCallback } from './useRoomCreatedCallback';\nimport { useUserCreatedCallback } from './useUserCreatedCallback';\nimport { useCheckRoomExistsCallback } from './useCheckRoomExistsCallback';\nimport { useMaxUsersReachedCallback } from './useMaxUsersReachedCallback';\nimport { useResetRoomCallback } from './useResetRoomCallback';\nimport { useRevealVotesCallback } from './useRevealVotesCallback';\nimport { useUserDroppedCallback } from './useUserDroppedCallback';\nimport { useUserJoinedCallback } from './useUserJoinedCallback';\nimport { useAttendeeLeftRoomCallback } from './useAttendeeLeftRoomCallback';\n\ntype EventsCallbacks = { [key in EventType]?: EventCallback<any> };\n\nexport const useEventsCallback = (params: CallbackHookParams) => {\n  const attendeeVotedCallback = useAttendeeVotedCallback(params);\n  const roomCreatedCallback = useRoomCreatedCallback(params);\n  const userCreatedCallback = useUserCreatedCallback(params);\n  const checkRoomExistsCallback = useCheckRoomExistsCallback(params);\n  const maxUsersReachedCallback = useMaxUsersReachedCallback(params);\n  const userJoinedCallback = useUserJoinedCallback(params);\n  const userDroppedCallback = useUserDroppedCallback(params);\n  const revealVotesCallback = useRevealVotesCallback(params);\n  const resetRoomCallback = useResetRoomCallback(params);\n  const attendeeLeftRoomEventCallback = useAttendeeLeftRoomCallback(params);\n\n  const callbacks = useMemo(() => {\n    return {\n      [EventType.UserCreated]: userCreatedCallback,\n      [EventType.CheckRoomExists]: checkRoomExistsCallback,\n      [EventType.AttendeeVoted]: attendeeVotedCallback,\n      [EventType.RoomCreated]: roomCreatedCallback,\n      [EventType.ResetRoom]: resetRoomCallback,\n      [EventType.RevealVotes]: revealVotesCallback,\n      [EventType.UserDropped]: userDroppedCallback,\n      [EventType.UserJoined]: userJoinedCallback,\n      [EventType.MaxUsersReached]: maxUsersReachedCallback,\n      [EventType.AttendeeLeftRoom]: attendeeLeftRoomEventCallback\n    } as EventsCallbacks;\n  }, [attendeeVotedCallback,\n    roomCreatedCallback,\n    userCreatedCallback,\n    checkRoomExistsCallback,\n    maxUsersReachedCallback,\n    userJoinedCallback,\n    userDroppedCallback,\n    revealVotesCallback,\n    resetRoomCallback,\n    attendeeLeftRoomEventCallback\n  ]);\n\n  return useCallback((event: Event) => {\n    console.log(`Received event \"${event.type}\".`);\n    const callback = callbacks[event.type];\n    if (!callback) {\n      console.log(`[ERROR] Don't know how to handle \"${event.type}\" event.`);\n      return;\n    }\n    callback(event);\n  }, [callbacks]);\n};\n","import { useCallback } from 'react';\nimport { AttendeeVotedEvent, removeUserFromAttendees, Room } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useAttendeeVotedCallback = ([data, setData]: CallbackHookParams) => {\n  return useCallback((event: AttendeeVotedEvent) => {\n    if (data.room?.attendees && event.payload) {\n      const attendees = [event.payload.attendee, ...removeUserFromAttendees(event.payload.attendee.user, data.room?.attendees)];\n      setData(previousState => {\n        return {\n          ...previousState,\n          room: {\n            ...previousState.room,\n            votingStatus: event.payload?.votingStatus,\n            attendees\n          } as Room\n        };\n      });\n    }\n  }, [data.room]);\n};\n","import { useCallback } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { RoomCreatedEvent } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useRoomCreatedCallback = ([, setData]: CallbackHookParams) => {\n  const history = useHistory();\n  return useCallback((event: RoomCreatedEvent) => {\n    if (event.payload) {\n      setData(previousState => {\n        return {\n          ...previousState,\n          room: event.payload?.room,\n          attendee: event.payload?.room.attendees[0]\n        };\n      });\n      history.push(`/${event.payload.room.id}`);\n    }\n  }, [history]);\n};\n","import { useCallback } from 'react';\nimport { UserCreatedEvent } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useUserCreatedCallback = ([, setData]: CallbackHookParams) => {\n  return useCallback((event: UserCreatedEvent) => {\n    if (event.payload) {\n      setData(previousState => {\n        return {\n          ...previousState,\n          user: event.payload?.user\n        };\n      });\n    }\n  }, []);\n};\n","import { useCallback } from 'react';\nimport { useHistory } from 'react-router';\nimport { CheckRoomExistsEvent } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useCheckRoomExistsCallback = ([data, setData]: CallbackHookParams) => {\n  const history = useHistory();\n  return useCallback((event: CheckRoomExistsEvent) => {\n    if (event.payload) {\n      if (!event.payload.exists) {\n        setData(previousState => {\n          return {\n            ...previousState,\n            room: undefined\n          };\n        });\n        history.push('/');\n      } else {\n        setData(previousState => {\n          return {\n            ...previousState,\n            room: event.payload?.room\n          };\n        });\n      }\n    }\n  }, [history, data.room]);\n};\n","import { useCallback } from 'react';\nimport { CallbackHookParams } from '../types';\n\nexport const useMaxUsersReachedCallback = ([data]: CallbackHookParams) => {\n  return useCallback(() => {\n    data.subjects.$connected.next(false);\n  }, []);\n};\n","import { useCallback } from 'react';\nimport { UserJoinedEvent } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useUserJoinedCallback = ([data, setData]: CallbackHookParams) => {\n  return useCallback((event: UserJoinedEvent) => {\n    if (data.room && event.payload && data.room.id === event.payload.room.id) {\n      setData(previousState => {\n        return {\n          ...previousState,\n          room: event.payload?.room\n        };\n      });\n      if (!data.attendee) {\n        const roomAttendee = event.payload.room.attendees.find(att => att?.user.id === data.user?.id);\n        if (roomAttendee) {\n          setData(previousState => {\n            return {\n              ...previousState,\n              attendee: roomAttendee\n            };\n          });\n        }\n      }\n    }\n  }, [data.room, data.attendee, data.user]);\n};\n","import { useCallback } from 'react';\nimport { Room, Toast, ToastType, UserDroppedEvent } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useUserDroppedCallback = ([data, setData]: CallbackHookParams) => {\n  return useCallback((event: UserDroppedEvent) => {\n    if (data.room && event.payload) {\n      const droppedAttendee = data.room.attendees\n        .find(attendee => attendee.user.id === event.payload?.user.id);\n\n      const remainingAttendees = data.room.attendees\n        .filter(attendee => attendee !== droppedAttendee);\n\n      const toast: Toast = {\n        message: `${droppedAttendee?.icon} dropped.`,\n        type: ToastType.INFORMATION\n      };\n\n      if (event.payload.newRoomOwner) {\n        debugger;\n        const newRoomOwner = remainingAttendees.find(attendee => attendee.user.id === event.payload?.newRoomOwner?.user.id);\n        if (newRoomOwner) {\n          newRoomOwner.roomOwner = true;\n\n          toast.message = `${toast.message} New room owner is ${newRoomOwner?.icon}.`;\n        }\n      }\n\n      data.subjects.$toast.next(toast);\n\n      setData(previousState => {\n        return {\n          ...previousState,\n          room: {\n            ...previousState.room,\n            attendees: remainingAttendees\n          } as Room\n        };\n      });\n    }\n  }, [data.room]);\n};\n","import { useCallback } from 'react';\nimport { Room, VotingStatus } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useRevealVotesCallback = ([, setData]: CallbackHookParams) => {\n  return useCallback(() => {\n    setData(previousState => {\n      return {\n        ...previousState,\n        room: {\n          ...previousState.room,\n          votingStatus: VotingStatus.Closed\n        } as Room\n      };\n    });\n  }, []);\n};\n","import { useCallback } from 'react';\nimport { ResetRoomEvent } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useResetRoomCallback = ([, setData]: CallbackHookParams) => {\n  return useCallback((event: ResetRoomEvent) => {\n    if (event.payload) {\n      setData(previousState => {\n        return {\n          ...previousState,\n          room: event.payload?.room\n        };\n      });\n    }\n  }, []);\n};\n","import { useCallback } from 'react';\nimport { AttendeeLeftRoomEvent, removeAttendeeFromAttendees, removeUserFromAttendees, Room, Toast, ToastType } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useAttendeeLeftRoomCallback = ([data, setData]: CallbackHookParams) => {\n  return useCallback((event: AttendeeLeftRoomEvent) => {\n    if (event.payload) {\n      /* User is the actual attendee. */\n      if (data.attendee && data.attendee.user.id === event.payload.attendee.user.id) {\n        setData(previousState => {\n          return {\n            ...previousState,\n            room: undefined,\n            attendee: undefined\n          };\n        });\n      } else {\n        debugger;\n        if (data.room?.attendees) {\n          let remainingAttendees = [...removeAttendeeFromAttendees(event.payload?.attendee, data.room?.attendees)];\n          if (event.payload.newRoomOwner) {\n            remainingAttendees = [...removeUserFromAttendees(event.payload.newRoomOwner.user, remainingAttendees), event.payload.newRoomOwner];\n            const toast : Toast = {\n              message: `${event.payload.attendee.icon} left. New room owner is ${event.payload.newRoomOwner.icon}.`,\n              type: ToastType.INFORMATION\n            };\n            data.subjects.$toast.next(toast);\n          }\n          setData(previousState => {\n            return {\n              ...previousState,\n              room: {\n                ...previousState.room,\n                attendees: remainingAttendees\n              } as Room\n            };\n          });\n        }\n      }\n    }\n  }, [data.attendee, data.room]);\n};\n","import { useCallback, useEffect, useState } from 'react';\nimport { Subscription } from 'rxjs';\nimport { useWebSocketCallbacks } from './useWebSocketCallbacks';\nimport { CallbackHookParams } from './types';\nimport { toast as showToast, ToastOptions } from 'react-toastify';\nimport { Toast, ToastType } from '../../shared/model';\n\ninterface Subscriptions {\n  connection?: Subscription,\n  events?: Subscription,\n  toasts?: Subscription\n}\n\nconst toastOptions: ToastOptions = {\n  position: 'top-right',\n  autoClose: 3000,\n  hideProgressBar: false,\n  closeOnClick: true,\n  pauseOnHover: true,\n  draggable: false,\n  progress: undefined\n};\n\nexport const useSubscriptions = (params: CallbackHookParams) => {\n\n  const [subscriptions, setSubscriptions] = useState<Subscriptions>();\n  const [eventsCallback, connectionCallback] = useWebSocketCallbacks(params);\n  const toastsCallback = useCallback((toast: Toast) => {\n    switch (toast.type) {\n      case ToastType.INFORMATION: {\n        showToast.info(toast.message, toastOptions);\n        break;\n      }\n      case ToastType.ERROR: {\n        showToast.error(toast.message, toastOptions);\n        break;\n      }\n      case ToastType.WARNING: {\n        showToast.warn(toast.message, toastOptions);\n        break;\n      }\n      default:\n        showToast(toast.message, toastOptions);\n    }\n  }, []);\n  const [data] = params;\n\n  useEffect(() => {\n    subscriptions?.events?.unsubscribe();\n    subscriptions?.connection?.unsubscribe();\n    subscriptions?.toasts?.unsubscribe();\n\n    const events = data.subjects.$in.subscribe(eventsCallback);\n    const connection = data.subjects.$connected.subscribe(connectionCallback);\n    const toasts = data.subjects.$toast.subscribe(toastsCallback);\n\n    setSubscriptions({\n      events,\n      connection,\n      toasts\n    });\n\n    return () => {\n      subscriptions?.events?.unsubscribe();\n      subscriptions?.connection?.unsubscribe();\n    };\n  }, [eventsCallback, connectionCallback]);\n};\n","import { useCallback } from 'react';\nimport { Event, ToastType } from '../../shared/model';\nimport { useEventsCallback } from './events-callback';\nimport { CallbackHookParams } from './types';\n\nexport const useWebSocketCallbacks = (params: CallbackHookParams):\n[(event: Event) => void, (conn: boolean) => void] => {\n\n  const [data, setData] = params;\n  const connectionCallback = useCallback((connected: boolean) => {\n    if (data.connected) {\n      if (!connected) {\n        data.subjects.$toast.next({\n          message: 'Disconnected from server.',\n          type: ToastType.WARNING\n        });\n      }\n    } else {\n      if (!connected) {\n        data.subjects.$toast.next({\n          message: 'Could not connect with server.',\n          type: ToastType.ERROR\n        });\n      }\n    }\n    setData(previousState => {\n      return {\n        ...previousState,\n        connected\n      };\n    });\n  }, []);\n\n  const eventsCallback = useEventsCallback(params);\n\n  return [eventsCallback, connectionCallback];\n};\n","import { DependencyList, useCallback, useState } from 'react';\n\nexport const useUpdateState = (deps: DependencyList) => {\n  const [, updateState] = useState<Object>();\n  useCallback(() => {\n    updateState({});\n  }, [deps]);\n};\n","import { makeStyles, createStyles } from '@material-ui/core';\n\nexport const useStyles = makeStyles(createStyles({\n  muiSlider: {\n    padding: '4px 0px'\n  },\n  typography: {\n    fontSize: '0.8rem'\n  },\n  muiSliderGridItem: {\n    padding: '4px 0px'\n  }\n}));\n","import { Grid, Slider as MuiSlider, Typography } from '@material-ui/core';\nimport { useUpdateState } from '../../../../../shared/hooks';\nimport { useStyles } from './hooks';\n\ninterface Props {\n  label: string,\n  value: number,\n  hide?: boolean\n}\n\nexport const Slider = ({ label, value, hide }: Props) => {\n  const styles = useStyles();\n\n  useUpdateState([value, hide]);\n\n  if (hide) {\n    return <></>;\n  }\n\n  return <Grid\n    container\n    alignItems='center'\n    spacing={2}>\n    <Grid\n      item\n      xs={3}>\n      <Typography\n        align='right'\n        className={styles.typography}>\n        {label}:\n      </Typography>\n    </Grid>\n    <Grid\n      item\n      xs={7}\n      className={styles.muiSliderGridItem}>\n      <MuiSlider\n        key={`${label}-${value}-${String(hide)}`}\n        disabled\n        marks\n        min={0}\n        max={6}\n        defaultValue={value}\n        className={styles.muiSlider} />\n    </Grid>\n    <Grid\n      item\n      xs={2}>\n      <Typography\n        align='left'\n        className={styles.typography} >\n        {value}\n      </Typography>\n    </Grid>\n  </Grid>;\n};\n","import { makeStyles, createStyles, lighten } from '@material-ui/core/styles';\n\nexport const useStyles = makeStyles(theme => createStyles({\n  attendeeCard: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center'\n  },\n  attendeeCardContent: {\n    padding: '4px',\n    minHeight: '48px',\n    '&:last-child': {\n      paddingBottom: '4px'\n    }\n  },\n  currentUser: {\n    background: theme.palette.primary.dark\n  },\n  currentUserVoted: {\n    background: lighten(theme.palette.primary.dark, 0.2)\n  },\n  otherUserVoted: {\n    background: lighten(theme.palette.background.paper, 0.2)\n  },\n  iconTypography: {\n    fontSize: '1.5rem'\n  }\n}));\n","import { useMemo } from 'react';\nimport { Card, CardContent, Grid, Typography } from '@material-ui/core';\nimport { Attendee as AttendeeModel, Room, User, VotingStatus } from '../../../../shared/model';\nimport { useUpdateState } from '../../../../shared/hooks';\nimport { Slider } from './slider';\nimport { useStyles } from './hooks';\n\ninterface Props {\n  user: User,\n  room: Room,\n  attendee: AttendeeModel\n}\n\nexport const Attendee = ({ user, room, attendee }: Props) => {\n\n  const styles = useStyles();\n\n  useUpdateState([user, room, attendee]);\n\n  const hideSlider = useMemo(() =>\n    (attendee.user.id !== user.id &&\n      room.votingStatus === VotingStatus.Open) ||\n    !attendee.vote,\n  [attendee, room.votingStatus]);\n\n  let cardClassName = styles.attendeeCard;\n\n  if (user.id === attendee.user.id) {\n    cardClassName += ` ${attendee.vote ? styles.currentUserVoted : styles.currentUser}`;\n  } else if (attendee.vote) {\n    cardClassName += ` ${styles.otherUserVoted}`;\n  }\n\n  return (\n    <Card\n      className={cardClassName} >\n      <CardContent className={styles.attendeeCardContent}>\n        <Grid\n          container>\n          <Grid\n            container\n            item\n            alignContent='center'\n            justify='center'\n            xs={2}>\n            <Typography\n              align='left'\n              className={styles.iconTypography} >\n              {attendee.icon}\n            </Typography>\n          </Grid>\n          <Grid\n            container\n            item\n            xs={10}>\n            <Slider\n              label='Effort'\n              hide={hideSlider}\n              value={attendee.vote?.effort || 0} />\n            <Slider\n              label='Value'\n              hide={hideSlider}\n              value={attendee.vote?.value || 0} />\n          </Grid>\n        </Grid>\n      </CardContent>\n    </Card>\n  );\n};\n","import { Grid } from '@material-ui/core';\nimport { useUpdateState } from '../../../shared/hooks';\nimport { sortByJoinedAtWithCurrentUserFirst, User, Room } from '../../../shared/model';\nimport { Attendee } from './attendee';\n\ninterface Props {\n  room: Room,\n  user: User\n}\n\nexport const Attendees = ({ room, user }: Props) => {\n\n  useUpdateState([room, user]);\n\n  return (\n    <Grid\n      container\n      alignItems='flex-start'\n      justify='flex-start'\n      spacing={1} >\n      {\n        sortByJoinedAtWithCurrentUserFirst(room.attendees, user)\n          .map((attendee, index) =>\n            <Grid\n              item\n              key={`attendee-grid-${index}`}\n              xs={12}>\n              <Attendee\n                user={user}\n                room={room}\n                attendee={attendee} />\n            </Grid>)\n      }\n    </Grid >\n  );\n};\n","import { Button, Grid } from '@material-ui/core';\nimport { useMemo } from 'react';\nimport { Data, VotingStatus } from '../../../shared/model';\nimport { useButtonsCallback } from './hooks';\n\ninterface Props {\n  data: Data\n}\n\nexport const Controls = ({ data }: Props) => {\n\n  const { onResetButtonClick, onRevealButtonClick } = useButtonsCallback(data);\n\n  const noVotes = useMemo(() => {\n    if (!data.room?.attendees) {\n      return false;\n    }\n\n    return data.room\n      .attendees\n      .filter(attendee => attendee.vote)\n      .length === 0;\n  }, [data.room?.attendees]);\n\n  return (\n    <Grid\n      container>\n      <Grid\n        item\n        xs={2} />\n      <Grid\n        item\n        xs={2}>\n        <Button\n          variant='contained'\n          onClick={onResetButtonClick}>\n          Reset\n        </Button>\n      </Grid>\n      <Grid\n        item\n        xs={2}>\n        <Button\n          variant='contained'\n          disabled={noVotes || data.room?.votingStatus === VotingStatus.Closed}\n          onClick={onRevealButtonClick}>\n          Reveal\n        </Button>\n      </Grid>\n    </Grid>\n  );\n};\n","import { useCallback } from 'react';\nimport { buildResetRoomEvent, buildRevealVotesEvent, Data } from '../../../../shared/model';\n\ninterface Return {\n  onResetButtonClick: () => void,\n  onRevealButtonClick: () => void\n}\n\ntype Hook = (data: Data) => Return;\n\nexport const useButtonsCallback: Hook = (data) => {\n  const onResetButtonClick = useCallback(() => {\n    data.subjects.$out.next(buildResetRoomEvent());\n  }, [data]);\n\n  const onRevealButtonClick = useCallback(() => {\n    data.subjects.$out.next(buildRevealVotesEvent());\n  }, [data]);\n\n  return {\n    onResetButtonClick,\n    onRevealButtonClick\n  };\n};\n","import { useCallback } from 'react';\nimport { ChartPoint, ChartEventProps, roundChartPoint } from '../../../../shared/model';\nimport { useThrottledState } from '../../../../shared/hooks';\n\nexport const useOnMouseMoveCallback: () => [ChartPoint | undefined, (props?: ChartEventProps | undefined) => void] = () => {\n  const [suggestedPoint, setSuggestedPoint] = useThrottledState<ChartPoint | undefined>(undefined, 30, true);\n\n  const onMouseMoveCallback = useCallback((props?: ChartEventProps) => {\n    if (props) {\n      const { xValue, yValue } = props;\n      setSuggestedPoint(roundChartPoint(xValue, yValue));\n    }\n  }, [setSuggestedPoint]);\n\n  return [suggestedPoint, onMouseMoveCallback];\n};\n","import { useThrottleCallback } from '@react-hook/throttle';\nimport { SetStateAction, useState } from 'react';\n\nexport const useThrottledState: <T extends unknown>(initialState: T, fps?: number, leading?: boolean) => [T, (value: SetStateAction<T>) => void] =\n<T extends unknown>(initialState: T, fps?: number, leading?: boolean) => {\n  const [state, unthrottledSetState] = useState<T>(initialState);\n  const setState = useThrottleCallback(unthrottledSetState, fps, leading);\n\n  return [state, setState];\n};\n","import { createStyles, makeStyles } from '@material-ui/core/styles';\n\nexport const useStyles = makeStyles(theme => createStyles({\n  responsiveContainer: {\n    borderRadius: '10px',\n    background: theme.palette.grey[800]\n  }\n}));\n","const domainValues = {\n  min: 0,\n  max: 6\n};\n\nexport const mediumPoint = (domainValues.min + domainValues.max) / 2;\n\nexport const domainLimits = [domainValues.min, domainValues.max];\n\nexport const axisTicks = Array.from({ length: domainValues.max }, (_, index) => index)\n  .filter(value => value !== mediumPoint);\n","import { TooltipProps } from 'recharts';\nimport { NameType, ValueType } from 'recharts/types/component/DefaultTooltipContent';\nimport { ChartPoint } from '../../../shared/model';\n\ninterface ExtraProps {\n  points: ChartPoint[]\n}\n\ntype Props = TooltipProps<ValueType, NameType> & ExtraProps;\n\nexport const TooltipRenderer = ({ active, payload, points }: Props) => {\n  if (active && payload && payload[0]) {\n    const hoveredPoint = payload[0].payload as ChartPoint;\n\n    const hoveredLabels = points.filter(point =>\n      point.effort === hoveredPoint.effort &&\n      point.value === hoveredPoint.value)\n      .map(point => point.label);\n\n    if (hoveredLabels && hoveredLabels.length > 1) {\n\n      const itemsPerLine = Math.round(Math.sqrt(hoveredLabels.length));\n      const tooltipContent = hoveredLabels.reduce((acc, label, index) => {\n        acc += label;\n        if (index % itemsPerLine === 0) {\n          acc += '\\n';\n        }\n        return acc;\n      });\n\n      return <div style={{\n        backgroundColor: '#0008',\n        fontSize: '0.8rem',\n        letterSpacing: '0.5rem',\n        padding: '0.5rem 0rem 0.5rem 0.5rem',\n        borderRadius: '0.1rem',\n        whiteSpace: 'pre-wrap'\n      }}>\n        {tooltipContent}\n      </div>;\n    }\n  }\n  return <></>;\n};\n","import { Props } from 'recharts/types/component/Label';\n\nexport const VotesLabel = ({ x, y, width, value } : Props) => {\n\n  if (typeof x !== 'number' ||\n    typeof y !== 'number' ||\n    typeof width !== 'number') {\n    return <></>;\n  }\n\n  return (\n    <text\n      x={x + width / 2}\n      y={y + width / 2}\n      width={width}\n      height={width}\n      fill='#fff'\n      textAnchor='middle'\n      fontSize='1.5rem'\n      dominantBaseline='middle'>\n      <tspan>\n        {value}\n      </tspan>\n    </text>\n  );\n};\n","import {\n  CartesianGrid,\n  LabelList,\n  ReferenceLine,\n  ResponsiveContainer,\n  Scatter,\n  ScatterChart,\n  Tooltip,\n  XAxis,\n  YAxis\n} from 'recharts';\nimport { Data, VotingStatus } from '../../../shared/model';\nimport {\n  useCreateMeanPoint,\n  useOnClickCallback,\n  useOnMouseMoveCallback,\n  usePoints,\n  useStyles\n} from './hooks';\nimport { axisTicks, domainLimits, mediumPoint } from './constants';\nimport { useUpdateState } from '../../../shared/hooks';\nimport { TooltipRenderer } from './TooltipRenderer';\nimport { VotesLabel } from './VotesLabel';\nimport { useTheme } from '@material-ui/core';\n\ninterface Props {\n  data: Data\n}\n\n/* Recharts does not allow custom component creation... ¯\\_(ツ)_/¯ */\nexport const EffortValueChart = ({ data }: Props) => {\n\n  const theme = useTheme();\n  const points = usePoints(data);\n  const [suggestedPoint, onMouseMoveCallback] = useOnMouseMoveCallback();\n  const onClickCallback = useOnClickCallback(data);\n  useUpdateState([data.attendee?.vote]);\n  const styles = useStyles();\n  const createMeanPoint = useCreateMeanPoint();\n\n  return (\n    <ResponsiveContainer\n      aspect={1.6}\n      width='99%'\n      className={styles.responsiveContainer}>\n      <ScatterChart\n        margin={{\n          top: 40,\n          bottom: 40,\n          left: 40,\n          right: 40\n        }}\n        onMouseMove={onMouseMoveCallback}\n        onClick={onClickCallback}\n      >\n        <XAxis\n          dataKey='value'\n          type='number'\n          axisLine={false}\n          hide={false}\n          ticks={axisTicks}\n          domain={domainLimits}\n          stroke={theme.palette.primary.dark} />\n        <YAxis\n          dataKey='effort'\n          type='number'\n          axisLine={false}\n          hide={false}\n          ticks={axisTicks}\n          domain={domainLimits}\n          stroke={theme.palette.primary.dark} />\n        <ReferenceLine\n          x={mediumPoint}\n          stroke={theme.palette.primary.dark}\n          strokeWidth={2}\n          label={{\n            position: 'insideBottomLeft',\n            value: 'Effort',\n            fill: theme.palette.primary.dark\n          }}\n        />;\n        <ReferenceLine\n          y={mediumPoint}\n          stroke={theme.palette.primary.dark}\n          strokeWidth={2}\n          label={{\n            position: 'insideBottomLeft',\n            value: 'Value',\n            fill: theme.palette.primary.dark\n          }}\n        />\n        <CartesianGrid\n          strokeDasharray='2 4'\n          stroke={theme.palette.grey[400]} />\n        <Scatter\n          data={points}\n          isAnimationActive={false}\n          strokeOpacity={1}\n          strokeWidth={10}\n          fill=\"#fff\">\n          <LabelList\n            dataKey='label'\n            fontSize='4rem'\n            content={<VotesLabel />}\n          />\n        </Scatter>\n        {data.room?.votingStatus === VotingStatus.Open &&\n          suggestedPoint &&\n          <Scatter\n            data={[suggestedPoint]}\n            shape='cross'\n            rotate={200}\n            strokeWidth={12}\n            strokeOpacity={0.5}\n            fillOpacity={1}\n            fill={theme.palette.secondary.dark}>\n          </Scatter>}\n        {data.room?.votingStatus === VotingStatus.Closed &&\n          <Scatter\n            data={createMeanPoint(points)}\n            shape='cross'\n            rotate={200}\n            strokeWidth={12}\n            strokeOpacity={0.5}\n            fillOpacity={1}\n            fill={theme.palette.primary.dark}>\n          </Scatter>}\n        <Tooltip content={<TooltipRenderer points={points} />} />\n      </ScatterChart>\n    </ResponsiveContainer>\n  );\n};\n","import { useMemo } from 'react';\nimport { createChartPoint, Data, retrieveAttendeeForUser, VotingStatus } from '../../../../shared/model';\n\nexport const usePoints = (data: Data) => {\n  return useMemo(() => {\n    if (data.room?.attendees && data.user) {\n      if (data.room.votingStatus === VotingStatus.Open) {\n        const attendee = retrieveAttendeeForUser(data.room?.attendees, data.user);\n        if (attendee?.vote) {\n          return [createChartPoint(attendee)];\n        }\n      } else {\n        return data.room\n          .attendees\n          .filter(attendee => attendee.vote)\n          .map(attendee => createChartPoint(attendee));\n      }\n    }\n    return [];\n  }, [data.room, data.user]);\n};\n","import { useCallback } from 'react';\nimport {\n  Attendee,\n  buildAttendeeVotedEvent,\n  ChartEventProps,\n  createVote,\n  Data,\n  VotingStatus\n} from '../../../../shared/model';\n\nexport const useOnClickCallback = (data: Data) => {\n  return useCallback((props: ChartEventProps) => {\n    if (props &&\n      data.user &&\n      data.room?.attendees &&\n      data.room.votingStatus === VotingStatus.Open) {\n      const { xValue, yValue } = props;\n      const vote = createVote(xValue, yValue);\n      const attendee = { ...data.attendee, vote } as Attendee;\n      data.subjects.$out.next(buildAttendeeVotedEvent(attendee));\n    }\n  }, [data]);\n};\n","import { useCallback } from 'react';\nimport { ChartPoint } from '../../../../shared/model';\n\nexport const useCreateMeanPoint = () => {\n  return useCallback((points: ChartPoint[]) => {\n    const initialValue = {\n      value: 0,\n      effort: 0,\n      label: 'Mean'\n    };\n    const mean = points.reduce((acc, point) => {\n      acc.effort += point.effort;\n      acc.value += point.value;\n\n      return acc;\n    }, initialValue);\n\n    mean.value /= points.length;\n    mean.effort /= points.length;\n\n    return [mean];\n  }, []);\n};\n","import { Grid } from '@material-ui/core';\nimport { useMemo } from 'react';\nimport { useUpdateState } from '../../shared/hooks';\nimport { Data, retrieveAttendeeForUser } from '../../shared/model';\nimport { Attendees } from './attendees';\nimport { Controls } from './controls';\nimport { EffortValueChart } from './effort-value-chart';\nimport { useEventsCallback } from './hooks';\n\ninterface Params {\n  data: Data\n}\n\nexport const Room = ({ data }: Params) => {\n\n  useUpdateState([data.room]);\n  useEventsCallback(data);\n\n  const roomOwner = useMemo(() => {\n    if (data.room?.attendees && data.user) {\n      const userAttendee = retrieveAttendeeForUser(data.room?.attendees, data.user);\n      return userAttendee?.roomOwner || false;\n    }\n    return false;\n  }, [data]);\n\n  return (\n    <Grid\n      container\n      direction='row'\n      spacing={1}>\n      <Grid\n        item\n        xs={9}>\n        <EffortValueChart data={data} />\n      </Grid>\n      <Grid\n        item\n        xs={3}>\n        <>\n          {\n            data.user &&\n            data.room &&\n            <Attendees\n              user={data.user}\n              room={data.room} />\n          }\n        </>\n      </Grid>\n      <Grid\n        item\n        xs={12}>\n        {roomOwner && <Controls data={data} />}\n      </Grid>\n    </Grid>\n  );\n};\n","import { useCallback, useEffect, useState } from 'react';\nimport { useParams } from 'react-router';\nimport { Subscription } from 'rxjs';\nimport {\n  buildCheckRoomExists,\n  buildJoinUserEvent,\n  CheckRoomExistsPayload,\n  Data,\n  Event,\n  EventType,\n  Room\n} from '../../../shared/model';\n\nexport const useEventsCallback = (data: Data) => {\n\n  const [eventsSubscription, setEventsSubscription] = useState<Subscription>();\n  const { roomId } = useParams<{ roomId: string }>();\n\n  const { connected, user, subjects } = data;\n  const eventsCallback = useCallback((event: Event) => {\n    if (event.type === EventType.CheckRoomExists) {\n      const payload = event.payload as CheckRoomExistsPayload;\n      if (user && payload && payload.exists) {\n        subjects.$out.next(buildJoinUserEvent(user, payload.room));\n      }\n    }\n  }, [user]);\n\n  useEffect(() => {\n    if (connected && user) {\n      eventsSubscription?.unsubscribe();\n      setEventsSubscription(subjects.$in.subscribe(eventsCallback));\n\n      subjects.$out.next(buildCheckRoomExists({\n        id: parseInt(roomId)\n      } as Room));\n      return () => eventsSubscription?.unsubscribe();\n    }\n  }, [connected, user, roomId]);\n};\n","import { Typography } from '@material-ui/core';\n\nexport const Title = () =>\n  <Typography\n    variant='h2'\n    align='center'\n    style={{\n      textDecoration: 'underline',\n      textShadow: '0px 0px 4px #888'\n    }}>\n    Pitanga\n  </Typography>;\n","import { Grid } from '@material-ui/core';\nimport { Switch, Route } from 'react-router-dom';\nimport { Container } from './container';\nimport { Home } from './home';\nimport { useSubscriptions, useDataState, useCheckAttendeeLeftRoomCallback } from './hooks';\nimport { Room } from './room';\nimport { Title } from './Title';\n\nexport function App() {\n\n  const dataState = useDataState();\n  useSubscriptions(dataState);\n  useCheckAttendeeLeftRoomCallback(dataState);\n  const [data] = dataState;\n\n  return (\n    <Container>\n      <Grid\n        container\n        direction='row'\n        spacing={1}>\n        <Grid\n          item\n          xs={12}>\n          <Title />\n        </Grid>\n        <Grid\n          item\n          xs={12}>\n          <Switch>\n            <Route path='/:roomId'>\n              <Room data={data} />\n            </Route>\n            <Route path='/'>\n              <Home\n                data={data} />\n            </Route>\n          </Switch>\n        </Grid>\n      </Grid>\n    </Container>\n  );\n}\n","import { useWebSocketSubjects } from './useWebSocketSubjects';\nimport { Data } from '../../shared/model';\nimport { useState } from 'react';\n\nexport const useDataState = () => {\n\n  const subjects = useWebSocketSubjects();\n\n  return useState<Data>({\n    connected: false,\n    subjects\n  });\n};\n","import { useHistory } from 'react-router-dom';\nimport { buildAttendeeLeftRoomEvent } from '../../shared/model';\nimport { Location, UnregisterCallback } from 'history';\nimport { DependencyList, useCallback, useState } from 'react';\nimport { CallbackHookParams } from './types';\n\ninterface UnregisterCallbackControl {\n  callback?: UnregisterCallback,\n  deps?: DependencyList\n}\n\nexport const useCheckAttendeeLeftRoomCallback = ([data]: CallbackHookParams) => {\n\n  const history = useHistory();\n\n  const deps: DependencyList = [data.room?.id, data.attendee];\n\n  const checkAttendeeLeftRoomCallback = useCallback((location: Location) => {\n    console.log(`[CB] Checking if user has left the room. Room id: ${data.room?.id}, pathname: ${location.pathname}`);\n    if (data.room?.id) {\n      if (!location.pathname.match(new RegExp(`/${data.room?.id}`))) {\n        console.log('[CB] Sending \"attendee-left-room\" event.');\n        data.attendee && data.subjects.$out.next(buildAttendeeLeftRoomEvent(data.attendee));\n      }\n    }\n  }, [data.room?.id, data.attendee]);\n\n  const [unregisterCallbackControl, setUnregisterCallbackControl] = useState<UnregisterCallbackControl>({});\n\n  if (!unregisterCallbackControl.callback) {\n    console.log('[CBR] Registering callback for the first time.');\n    setUnregisterCallbackControl({\n      callback: history.listen(checkAttendeeLeftRoomCallback),\n      deps: deps\n    });\n  } else {\n    if (!unregisterCallbackControl.deps?.every((element, index) => element === deps[index])) {\n      console.log('[CBR] Updating callback.');\n      unregisterCallbackControl.callback();\n      setUnregisterCallbackControl({\n        callback: history.listen(checkAttendeeLeftRoomCallback),\n        deps: deps\n      });\n    }\n  }\n};\n","import { render } from 'react-dom';\nimport { HashRouter } from 'react-router-dom';\nimport '@fontsource/roboto';\nimport { ThemeController } from './theme-controller';\nimport { App } from './app';\nimport { ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nrender(\n  /*\n    Github pages is not too friendly for single page applications. We have to use hash route to allow navigation.\n    Looking forward for this issue to be solved: https://github.com/isaacs/github/issues/408\n  */\n  <HashRouter>\n    <ThemeController>\n      <App />\n    </ThemeController>\n    <ToastContainer\n      position=\"bottom-right\" />\n  </HashRouter>,\n  document.getElementById('root')\n);\n","export * from './Room';\nexport * from './User';\nexport * from './events';\nexport * from './Attendee';\nexport * from './Data';\nexport * from './ChartEventProps';\nexport * from './ChartPoint';\nexport * from './Vote';\nexport * from './VotingStatus';\nexport * from './Toast';\n"],"sourceRoot":""}
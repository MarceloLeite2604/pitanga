{"version":3,"sources":["config.js","shared/model/Room.ts","shared/model/User.ts","shared/model/events/index.ts","shared/model/events/CheckRoomExists.ts","shared/model/events/CreateRoom.ts","shared/model/events/JoinUser.ts","shared/model/events/AttendeeVoted.ts","shared/model/events/RevealVotes.ts","shared/model/events/ResetRoom.ts","shared/model/events/AttendeeLeftRoom.ts","shared/model/Attendee.ts","shared/model/ChartPoint.ts","shared/model/Vote.ts","shared/model/VotingStatus.ts","shared/model/Toast.ts","app/hooks/useWebSocketSubjects.ts","shared/model/events/EventType.ts","theme-controller/ThemeController.tsx","theme-controller/hooks/useTheme.ts","app/container/BoxMargin.tsx","app/container/hooks/useStyles.ts","app/container/Container.tsx","app/home/GridItem.tsx","app/home/hooks/useStyles.tsx","app/home/Home.tsx","app/hooks/events-callback/useEventsCallback.ts","app/hooks/events-callback/useAttendeeVotedCallback.ts","app/hooks/events-callback/useRoomCreatedCallback.ts","app/hooks/events-callback/useUserCreatedCallback.ts","app/hooks/events-callback/useCheckRoomExistsCallback.ts","app/hooks/events-callback/useMaxUsersReachedCallback.ts","app/hooks/events-callback/useUserJoinedCallback.ts","app/hooks/events-callback/useUserDroppedCallback.ts","app/hooks/events-callback/useRevealVotesCallback.ts","app/hooks/events-callback/useResetRoomCallback.ts","app/hooks/events-callback/useAttendeeLeftRoomCallback.ts","app/hooks/useSubscriptions.ts","app/hooks/useWebSocketCallbacks.ts","shared/hooks/useUpdateState.tsx","app/room/attendees/attendee/slider/hooks/useStyles.ts","app/room/attendees/attendee/slider/Slider.tsx","app/room/attendees/attendee/hooks/useStyles.ts","app/room/attendees/attendee/Attendee.tsx","app/room/attendees/Attendees.tsx","app/room/controls/Controls.tsx","app/room/controls/hooks/useButtonsCallback.ts","app/room/effort-value-chart/hooks/useOnMouseMoveCallback.ts","shared/hooks/useThrottledState.tsx","app/room/effort-value-chart/hooks/useStyles.tsx","app/room/effort-value-chart/constants.ts","app/room/effort-value-chart/TooltipRenderer.tsx","app/room/effort-value-chart/VotesLabel.tsx","app/room/effort-value-chart/EffortValueChart.tsx","app/room/effort-value-chart/hooks/usePoints.ts","app/room/effort-value-chart/hooks/useOnClickCallback.ts","app/room/effort-value-chart/hooks/useCreateMeanPoint.ts","app/room/Room.tsx","app/room/hooks/useEventsCallback.ts","app/Title.tsx","app/App.tsx","app/hooks/useStateData.ts","app/hooks/useCheckAttendeeLeftRoomCallback.ts","index.tsx","shared/model/index.ts"],"names":["config","host","port","path","createRoom","id","atts","attendees","votingStatus","map","attendee","createAttendee","findAttendeeByUser","user","this","length","filter","sortAttendeesByJoinedAtWithUserFirst","sortedAttendees","sort","first","second","joinedAt","removeAttendeeByUserId","userId","createUser","buildCheckRoomExists","room","type","EventType","CheckRoomExists","payload","buildCreateRoomEvent","CreateRoom","buildJoinUserEvent","JoinUser","buildAttendeeVotedEvent","AttendeeVoted","buildRevealVotesEvent","RevealVotes","buildResetRoomEvent","ResetRoom","buildAttendeeLeftRoomEvent","AttendeeLeftRoom","icon","roomOwner","vote","createChartPoint","effort","value","label","x","y","Math","round","createVote","VotingStatus","ToastType","createClient","webSocketSubjects","client","W3CWebSocket","schema","location","protocol","configuration","elaborateWebsocketUri","onopen","$connected","next","onclose","onmessage","message","data","Buffer","ArrayBuffer","Error","JSON","parse","$in","useWebSocketSubjects","useState","Subject","$out","$toast","useEffect","subscribe","event","console","log","send","stringify","ThemeController","darkMode","children","prefersDarkMode","useMediaQuery","theme","useMemo","createMuiTheme","palette","primary","main","secondary","ThemeProvider","CssBaseline","BoxMargin","Box","component","Grid","display","md","xs","useStyles","makeStyles","createStyles","container","padding","Container","styles","alignItems","justify","spacing","className","item","GridItem","direction","joinRooomButton","marginTop","Home","connected","subjects","roomNumber","setRoomNumber","history","useHistory","joinRoom","useCallback","push","validateRoomNumber","roomNum","isNaN","parseInt","classes","joinRoomButtonDisabled","style","flexGrow","TextField","inputProps","maxLength","onChange","target","Button","variant","color","disabled","onClick","Typography","useEventsCallback","params","attendeeVotedCallback","setData","votingAttendee","previousState","useAttendeeVotedCallback","roomCreatedCallback","useRoomCreatedCallback","userCreatedCallback","useUserCreatedCallback","checkRoomExistsCallback","exists","undefined","useCheckRoomExistsCallback","maxUsersReachedCallback","useMaxUsersReachedCallback","userJoinedCallback","roomAttendee","find","att","useUserJoinedCallback","userDroppedCallback","droppedAttendee","remainingAttendees","toast","INFORMATION","newRoomOwner","useUserDroppedCallback","revealVotesCallback","Closed","useRevealVotesCallback","resetRoomCallback","useResetRoomCallback","attendeeLeftRoomEventCallback","useAttendeeLeftRoomCallback","callbacks","UserCreated","RoomCreated","UserDropped","UserJoined","MaxUsersReached","callback","toastOptions","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","useSubscriptions","subscriptions","setSubscriptions","connectionCallback","WARNING","ERROR","useWebSocketCallbacks","eventsCallback","toastsCallback","showToast","info","error","warn","events","unsubscribe","connection","toasts","useUpdateState","deps","updateState","muiSlider","typography","fontSize","muiSliderGridItem","Slider","hide","align","marks","min","max","defaultValue","String","attendeeCard","flexDirection","justifyContent","attendeeCardContent","minHeight","paddingBottom","currentUser","background","dark","currentUserVoted","lighten","otherUserVoted","paper","iconTypography","Attendee","hideSlider","Open","cardClassName","Card","CardContent","alignContent","Attendees","index","Controls","onResetButtonClick","onRevealButtonClick","useButtonsCallback","noVotes","useOnMouseMoveCallback","initialState","fps","leading","state","unthrottledSetState","useThrottleCallback","useThrottledState","suggestedPoint","setSuggestedPoint","props","xValue","yValue","responsiveContainer","borderRadius","grey","domainValues","mediumPoint","domainLimits","axisTicks","Array","from","_","TooltipRenderer","active","points","hoveredPoint","hoveredLabels","point","itemsPerLine","sqrt","tooltipContent","reduce","acc","backgroundColor","letterSpacing","whiteSpace","VotesLabel","width","height","fill","textAnchor","dominantBaseline","EffortValueChart","useTheme","usePoints","onMouseMoveCallback","onClickCallback","useOnClickCallback","createMeanPoint","mean","ResponsiveContainer","aspect","ScatterChart","margin","top","bottom","left","right","onMouseMove","XAxis","dataKey","axisLine","ticks","domain","stroke","YAxis","ReferenceLine","strokeWidth","CartesianGrid","strokeDasharray","Scatter","isAnimationActive","strokeOpacity","LabelList","content","shape","rotate","fillOpacity","Tooltip","Room","eventsSubscription","setEventsSubscription","roomId","useParams","userAttendee","Title","textDecoration","textShadow","App","dataState","useDataState","checkAttendeeLeftRoomCallback","pathname","match","RegExp","unregisterCallbackControl","setUnregisterCallbackControl","every","element","listen","useCheckAttendeeLeftRoomCallback","render","document","getElementById"],"mappings":"wIAYMA,EANa,CACjBC,KAAM,yCACNC,KAAM,GACNC,KAAM,YAKO,mBACVH,I,+FCMQI,EAAa,WAIG,IAAD,yDAAxB,GAHFC,EAG0B,EAH1BA,GACWC,EAEe,EAF1BC,UACAC,EAC0B,EAD1BA,aAEMD,EAAYD,EAAKG,KAAI,SAAAC,GAAQ,OAAIC,yBAAeD,MACtD,MAAO,CACLL,KACAE,YACAC,eACAI,mBAJK,SAIcC,GACjB,GAA8B,IAA1BC,KAAKP,UAAUQ,QAAiBF,EAIpC,OAAOC,KAAKP,UAAUS,QAAO,SAAAN,GAAQ,OAAIA,EAASG,KAAKR,KAAOQ,EAAKR,MAAI,IAEzEY,qCAXK,SAWgCJ,GACnC,IAAMK,EAAe,YAAOJ,KAAKP,WAYjC,OAXAW,EAAgBC,MAAK,SAACC,EAAOC,GAC3B,OAAID,EAAMP,KAAKR,KAAOQ,EAAKR,IACjB,EAGNgB,EAAOR,KAAKR,KAAOQ,EAAKR,GACnB,EAGFe,EAAME,SAAWD,EAAOC,YAE1B,2BACFR,MADL,IAEEP,UAAWW,KAGfK,uBA7BK,SA6BkBC,GACrB,OAA8B,IAA1BV,KAAKP,UAAUQ,QAAiBS,EAI7B,2BACFV,MADL,IAEEP,UAAWO,KAAKP,UAAUS,QAAO,SAAAN,GAAQ,OAAIA,EAASG,KAAKR,KAAOmB,OAL3D,eAAKV,U,iCCpDpB,kCAAO,IAAMW,EAAa,wEAEtB,GADFpB,EADwB,EACxBA,GADwB,MAEH,CACrBA,Q,iCCTF,goR,qDCEA,8CASO,SAASqB,EAAqBC,GACnC,MAAO,CACLC,KAAMC,IAAUC,gBAChBC,QAAS,CACPJ,W,iCCbN,8CAQO,SAASK,EAAqBnB,GACnC,MAAO,CACLe,KAAMC,IAAUI,WAChBF,QAAS,CACPlB,W,qDCZN,8CASO,SAASqB,EAAmBrB,EAAec,GAChD,MAAO,CACLC,KAAMC,IAAUM,SAChBJ,QAAS,CACPlB,OACAc,W,6KCbN,8CASO,SAASS,EAAwB1B,GACtC,MAAO,CACLkB,KAAMC,IAAUQ,cAChBN,QAAS,CACPrB,e,iCCfN,8CAIO,SAAS4B,IACd,MAAO,CACLV,KAAMC,IAAUU,e,iCCLpB,8CASO,SAASC,IACd,MAAO,CACLZ,KAAMC,IAAUY,a,iCCXpB,8CASO,SAASC,EAA2BhC,GACzC,MAAO,CACLkB,KAAMC,IAAUc,iBAChBZ,QAAS,CACPrB,e,iCCfN,6CAqBaC,EAAiB,wEAM1B,GALFE,EAD4B,EAC5BA,KACA+B,EAF4B,EAE5BA,KACAtB,EAH4B,EAG5BA,SACAuB,EAJ4B,EAI5BA,UACAC,EAL4B,EAK5BA,KAL4B,MAMH,CACzBjC,KAAMY,qBAAWZ,GACjB+B,OACAtB,WACAuB,YACAC,OACAC,iBANyB,WAMO,IAAD,IAC7B,MAAO,CACLC,QAAQ,UAAAlC,KAAKgC,YAAL,eAAWE,SAAU,EAC7BC,OAAO,UAAAnC,KAAKgC,YAAL,eAAWG,QAAS,EAC3BC,MAAOpC,KAAK8B,U,yEC/BlB,kCAAO,IAAMG,EAAmB,SAACI,EAAWC,EAAWF,GAAvB,MAA2C,CACzED,MAAOI,KAAKC,MAAMH,GAClBH,OAAQK,KAAKC,MAAMF,GACnBF,W,iCCFF,kCAAO,IAAMK,EAAa,SAACJ,EAAWC,GAAZ,MAA2B,CACnDH,MAAOI,KAAKC,MAAMH,GAClBH,OAAQK,KAAKC,MAAMF,M,iCCTd,IAAKI,EAAZ,kC,SAAYA,K,YAAAA,E,iBAAAA,M,uCCAL,IAAKC,EAAZ,kC,SAAYA,K,mBAAAA,E,kBAAAA,E,eAAAA,E,eAAAA,M,mICYZ,SAASC,EAAaC,GACpB,IAAMC,EAAS,IAAIC,eAPrB,WACE,IAAMC,EAA+B,WAAtBC,SAASC,SAAwB,OAAS,MACnD9D,EAA6B,WAAtB6D,SAASC,SAAwBC,IAAc/D,KAAO,IACnE,MAAM,GAAN,OAAU4D,EAAV,aAAqBG,IAAchE,KAAnC,YAA2CC,GAA3C,OAAkD+D,IAAc9D,MAIhC+D,IAkBhC,OAjBAN,EAAOO,OAAS,WACdR,EAAkBS,WAAWC,MAAK,IAGpCT,EAAOU,QAAU,WACfX,EAAkBS,WAAWC,MAAK,IAGpCT,EAAOW,UAAY,SAACC,GAClB,GAAIA,EAAQC,gBAAgBC,GAAUF,EAAQC,gBAAgBE,YAC5D,MAAM,IAAIC,MAAM,iCAGlB,IAAMH,EAAOI,KAAKC,MAAMN,EAAQC,MAChCd,EAAkBoB,IAAIV,KAAKI,IAGtBb,EAGF,IAAMoB,EAAuB,WAElC,MAA4BC,mBAA4B,CACtDb,WAAY,IAAIc,IAChBH,IAAK,IAAIG,IACTC,KAAM,IAAID,IACVE,OAAQ,IAAIF,MAJPvB,EAAP,oBAOA,EAAiBsB,oBAAS,kBAAMvB,EAAaC,MAAtCC,EAAP,oBASA,OAPAyB,qBAAU,WACR1B,EAAkBwB,KAAKG,WAAU,SAAAC,GAC/BC,QAAQC,IAAR,yBAA8BF,EAAM3D,KAApC,MACAgC,EAAO8B,KAAKb,KAAKc,UAAUJ,SAE5B,IAEI5B,K,0DCpDF,IAAK9B,EAAZ,kC,SAAYA,K,yBAAAA,E,2BAAAA,E,oCAAAA,E,qBAAAA,E,yBAAAA,E,6CAAAA,E,yBAAAA,E,2BAAAA,E,oCAAAA,E,oCAAAA,E,2BAAAA,E,+BAAAA,E,uBAAAA,E,2BAAAA,E,uCAAAA,M,6HCIC+D,EAAsB,SAAC,GAAkB,ICD7BC,EDCaC,EAAe,EAAfA,SAC9BC,EAAkBC,YAAc,gCAChCC,GCHiBJ,EDGAE,ECFhBG,mBAAQ,kBAAMC,YAAe,CAClCC,QAAS,CACPxE,KAAMiE,EAAW,OAAS,QAC1BQ,QAAS,CACPC,KAAM,WAERC,UAAW,CACTD,KAAM,gBAGR,CAACT,KDNL,OACE,eAACW,EAAA,EAAD,CAAeP,MAAOA,EAAtB,UACE,cAACQ,EAAA,EAAD,IACCX,M,iCETMY,EAAY,kBACvB,cAACC,EAAA,EAAD,CACEC,UAAWC,IACXC,QAAS,CACPC,GAAI,QACJC,GAAI,W,kBCLGC,EAAYC,YAAWC,YAAa,CAC/CC,UAAW,CACTC,QAAS,cCCAC,EAAgB,SAAC,GAAkB,IAAhBxB,EAAe,EAAfA,SAExByB,EAASN,IAEf,OAAO,eAACJ,EAAA,EAAD,CACLO,WAAS,EACTI,WAAW,SACXC,QAAQ,SACRC,QAAS,EACTC,UAAWJ,EAAOH,UALb,UAML,cAAC,EAAD,IACA,cAACP,EAAA,EAAD,CACEe,MAAI,EACJb,GAAI,GACJC,GAAI,GAHN,SAIGlB,IAEH,cAAC,EAAD,Q,kCCdS+B,EAAwB,SAAC,GAAkC,IAAhCb,EAA+B,EAA/BA,GAAIQ,EAA2B,EAA3BA,WAAY1B,EAAe,EAAfA,SAEtD,OACE,cAACe,EAAA,EAAD,CACEO,WAAS,EACTQ,MAAI,EACJZ,GAAIA,EACJc,UAAU,SACVL,QAAQ,aACRD,WAAYA,GAAc,SAN5B,SAOG1B,KChBMmB,EAAYC,YAAWC,YAAa,CAC/CY,gBAAiB,CACfC,UAAW,WCOFC,EAAO,SAAC,GAAsB,IAApBxD,EAAmB,EAAnBA,KAEbyD,EAA8BzD,EAA9ByD,UAAWrH,EAAmB4D,EAAnB5D,KAAMsH,EAAa1D,EAAb0D,SACzB,EAAoClD,qBAApC,mBAAOmD,EAAP,KAAmBC,EAAnB,KAEMC,EAAUC,cAEVC,EAAWC,uBAAY,WAC3BH,EAAQI,KAAR,UAAgBN,MACf,CAACE,EAASF,IAMPO,EAAqBF,uBAAY,SAACG,GAEtC,QAAKA,IAIkB,IAAnBA,EAAQ7H,SAIR8H,MAAMC,SAASF,OAKlB,IAEGG,EAAU9B,IAEV+B,GAA0Bd,IAAcrH,IAAS8H,EAAmBP,GAE1E,OACE,eAACvB,EAAA,EAAD,CACEO,WAAS,EACTM,QAAS,EACTF,WAAW,SACXyB,MAAO,CAAEC,SAAU,GAJrB,UAKE,cAAC,EAAD,CACElC,GAAI,EACJQ,WAAW,WAFb,SAGE,cAAC2B,EAAA,EAAD,CACE9I,GAAG,aACH6C,MAAM,cACNkG,WAAY,CACVC,UAAW,KAEbC,SAAU,SAAA/D,GAAK,OAAI8C,EAAc9C,EAAMgE,OAAOtG,YAElD,cAAC,EAAD,CACE+D,GAAI,EACJQ,WAAW,aAFb,SAGE,cAACgC,EAAA,EAAD,CACEC,QAAQ,YACRC,MAAM,UACNC,SAAUX,EACVY,QAASpB,EACTb,UAAWoB,EAAQhB,gBALrB,yBAOF,cAAC,EAAD,CAAUf,GAAI,GAAd,SACE,cAAC6C,EAAA,EAAD,mBAEF,cAAC,EAAD,CAAU7C,GAAI,GAAd,SACE,cAACwC,EAAA,EAAD,CACEC,QAAQ,YACRC,MAAM,UACNC,UAAWzB,IAAcrH,EACzB+I,QA5DoB,WAC1B/I,GAAQsH,EAAShD,KAAKd,KAAKrC,+BAAqBnB,KAuD5C,+B,yBC9DKiJ,EAAoB,SAACC,GAChC,IAAMC,ECbgC,SAAC,GAAyC,IAAD,mBAAvCvF,EAAuC,KAAjCwF,EAAiC,KAC/E,OAAOxB,uBAAY,SAAClD,GAA+B,IAAD,EAChD,IAAI,UAAAd,EAAK9C,YAAL,eAAWpB,YAAagF,EAAMxD,QAAS,CACzC,IAAMmI,EAAiBvJ,yBAAe4E,EAAMxD,QAAQrB,UAC9CiB,EAAO8C,EAAK9C,KAAKJ,uBAAuB2I,EAAerJ,KAAKR,IAClEsB,EAAKpB,UAAUmI,KAAKwB,GACpBvI,EAAKnB,aAAe+E,EAAMxD,QAAQvB,aAClCyJ,GAAQ,SAAAE,GACN,OAAO,2BACFA,GADL,IAEExI,eAIL,CAAC8C,EAAK9C,ODDqByI,CAAyBL,GACjDM,EET8B,SAAC,GAAqC,IAAlCJ,EAAiC,oBACnE3B,EAAUC,cAChB,OAAOE,uBAAY,SAAClD,GACdA,EAAMxD,UACRkI,GAAQ,SAAAE,GAAkB,IAAD,IACvB,OAAO,2BACFA,GADL,IAEExI,KAAMvB,qBAAU,UAACmF,EAAMxD,eAAP,aAAC,EAAeJ,MAChCjB,SAAUC,yBAAc,UAAC4E,EAAMxD,eAAP,aAAC,EAAeJ,KAAKpB,UAAU,SAG3D+H,EAAQI,KAAR,WAAiBnD,EAAMxD,QAAQJ,KAAKtB,QAErC,CAACiI,IFJwBgC,CAAuBP,GAC7CQ,EGf8B,SAAC,GAAqC,IAAlCN,EAAiC,oBACzE,OAAOxB,uBAAY,SAAClD,GACdA,EAAMxD,SACRkI,GAAQ,SAAAE,GAAkB,IAAD,EACvB,OAAO,2BACFA,GADL,IAEEtJ,KAAI,UAAE0E,EAAMxD,eAAR,aAAE,EAAelB,YAI1B,IHKyB2J,CAAuBT,GAC7CU,EIfkC,SAAC,GAAyC,IAAD,mBAAvChG,EAAuC,KAAjCwF,EAAiC,KAC3E3B,EAAUC,cAChB,OAAOE,uBAAY,SAAClD,GAClB,GAAIA,EAAMxD,QACR,GAAKwD,EAAMxD,QAAQ2I,OAQZ,CACL,IAAM/I,EAAOvB,qBAAWmF,EAAMxD,QAAQJ,MACtCsI,GAAQ,SAAAE,GACN,OAAO,2BACFA,GADL,IAEExI,iBAZJsI,GAAQ,SAAAE,GACN,OAAO,2BACFA,GADL,IAEExI,UAAMgJ,OAGVrC,EAAQI,KAAK,OAWhB,CAACJ,EAAS7D,EAAK9C,OJPciJ,CAA2Bb,GACrDc,EKlBkC,SAAC,GAAgC,IAA/BpG,EAA8B,oBACxE,OAAOgE,uBAAY,WACjBhE,EAAK0D,SAAS/D,WAAWC,MAAK,KAC7B,ILe6ByG,CAA2Bf,GACrDgB,EMd6B,SAAC,GAAyC,IAAD,mBAAvCtG,EAAuC,KAAjCwF,EAAiC,KAC5E,OAAOxB,uBAAY,SAAClD,GAClB,GAAId,EAAK9C,MAAQ4D,EAAMxD,SAAW0C,EAAK9C,KAAKtB,KAAOkF,EAAMxD,QAAQJ,KAAKtB,KACpE4J,GAAQ,SAAAE,GAAkB,IAAD,EACvB,OAAO,2BACFA,GADL,IAEExI,KAAMvB,qBAAU,UAACmF,EAAMxD,eAAP,aAAC,EAAeJ,YAG/B8C,EAAK/D,UAAU,CAClB,IAAMsK,EAAezF,EAAMxD,QAAQJ,KAAKpB,UAAU0K,MAAK,SAAAC,GAAG,aAAO,OAAHA,QAAG,IAAHA,OAAA,EAAAA,EAAKrK,KAAKR,OAAV,UAAiBoE,EAAK5D,YAAtB,aAAiB,EAAWR,OACtF2K,GACFf,GAAQ,SAAAE,GACN,OAAO,2BACFA,GADL,IAEEzJ,SAAUC,yBAAeqK,WAMlC,CAACvG,EAAK9C,KAAM8C,EAAK/D,SAAU+D,EAAK5D,ONPRsK,CAAsBpB,GAC3CqB,EOnB8B,SAAC,GAAyC,IAAD,mBAAvC3G,EAAuC,KAAjCwF,EAAiC,KAC7E,OAAOxB,uBAAY,SAAClD,GAClB,GAAId,EAAK9C,MAAQ4D,EAAMxD,QAAS,CAC9B,IAAMsJ,EAAkB5G,EAAK9C,KAAKpB,UAC/B0K,MAAK,SAAAvK,GAAQ,aAAIA,EAASG,KAAKR,MAAd,UAAqBkF,EAAMxD,eAA3B,aAAqB,EAAelB,KAAKR,OAEvDiL,EAAqB7G,EAAK9C,KAAKpB,UAClCS,QAAO,SAAAN,GAAQ,OAAIA,IAAa2K,KAE7BE,EAAe,CACnB/G,QAAQ,GAAD,cAAK6G,QAAL,IAAKA,OAAL,EAAKA,EAAiBzI,KAAtB,aACPhB,KAAM6B,YAAU+H,aAGlB,GAAIjG,EAAMxD,QAAQ0J,aAAc,CAE9B,IAAMA,EAAeH,EAAmBL,MAAK,SAAAvK,GAAQ,eAAIA,EAASG,KAAKR,MAAd,UAAqBkF,EAAMxD,eAA3B,iBAAqB,EAAe0J,oBAApC,aAAqB,EAA6B5K,KAAKR,OAC5GoL,IACFA,EAAa5I,WAAY,EAEzB0I,EAAM/G,QAAN,UAAmB+G,EAAM/G,QAAzB,qCAAsDiH,QAAtD,IAAsDA,OAAtD,EAAsDA,EAAc7I,KAApE,MAIJ6B,EAAK0D,SAAS/C,OAAOf,KAAKkH,GAE1BtB,GAAQ,SAAAE,GACN,OAAO,2BACFA,GADL,IAEExI,KAAK,2BACAwI,EAAcxI,MADf,IAEFpB,UAAW+K,YAKlB,CAAC7G,EAAK9C,OPjBmB+J,CAAuB3B,GAC7C4B,EQpB8B,SAAC,GAAqC,IAAlC1B,EAAiC,oBACzE,OAAOxB,uBAAY,WACjBwB,GAAQ,SAAAE,GACN,OAAO,2BACFA,GADL,IAEExI,KAAK,2BACAwI,EAAcxI,MADf,IAEFnB,aAAcgD,eAAaoI,gBAIhC,IRSyBC,CAAuB9B,GAC7C+B,ESrB4B,SAAC,GAAqC,IAAlC7B,EAAiC,oBACvE,OAAOxB,uBAAY,SAAClD,GAClB,GAAIA,EAAMxD,QAAS,CACjB,IAAMJ,EAAOvB,qBAAWmF,EAAMxD,QAAQJ,MACtCsI,GAAQ,SAAAE,GACN,OAAO,2BACFA,GADL,IAEExI,eAIL,ITUuBoK,CAAqBhC,GACzCiC,EUjBmC,SAAC,GAAyC,IAAD,mBAAvCvH,EAAuC,KAAjCwF,EAAiC,KAClF,OAAOxB,uBAAY,SAAClD,GAWR,IAAD,EAVT,GAAIA,EAAMxD,QAER,GAAI0C,EAAK/D,UAAY+D,EAAK/D,SAASG,KAAKR,KAAOkF,EAAMxD,QAAQrB,SAASG,KAAKR,GACzE4J,GAAQ,SAAAE,GACN,OAAO,2BACFA,GADL,IAEExI,UAAMgJ,EACNjK,cAAUiK,YAKd,aAAIlG,EAAK9C,YAAT,aAAI,EAAWpB,UAAW,CACxB,IAAIoB,EAAO8C,EAAK9C,KAAKJ,uBAAuBgE,EAAMxD,QAAQrB,SAASG,KAAKR,IACxE,GAAIkF,EAAMxD,QAAQ0J,aAAc,CAC9B,IAAMA,EAAe9K,yBAAe4E,EAAMxD,QAAQ0J,eAClD9J,EAAOA,EAAKJ,uBAAuBgE,EAAMxD,QAAQ0J,aAAa5K,KAAKR,KAC9DE,UAAUmI,KAAK+C,GACpB,IAAMF,EAAe,CACnB/G,QAAQ,GAAD,OAAKe,EAAMxD,QAAQrB,SAASkC,KAA5B,oCAA4D2C,EAAMxD,QAAQ0J,aAAa7I,KAAvF,KACPhB,KAAM6B,YAAU+H,aAElB/G,EAAK0D,SAAS/C,OAAOf,KAAKkH,GAE5BtB,GAAQ,SAAAE,GACN,OAAO,2BACFA,GADL,IAEExI,eAMT,CAAC8C,EAAK/D,SAAU+D,EAAK9C,OVlBcsK,CAA4BlC,GAE5DmC,EAAYhG,mBAAQ,WAAO,IAAD,EAC9B,OAAO,EAAP,iBACGrE,YAAUsK,YAAc5B,GAD3B,cAEG1I,YAAUC,gBAAkB2I,GAF/B,cAGG5I,YAAUQ,cAAgB2H,GAH7B,cAIGnI,YAAUuK,YAAc/B,GAJ3B,cAKGxI,YAAUY,UAAYqJ,GALzB,cAMGjK,YAAUU,YAAcoJ,GAN3B,cAOG9J,YAAUwK,YAAcjB,GAP3B,cAQGvJ,YAAUyK,WAAavB,GAR1B,cASGlJ,YAAU0K,gBAAkB1B,GAT/B,cAUGhJ,YAAUc,iBAAmBqJ,GAVhC,IAYC,CAAChC,EACFK,EACAE,EACAE,EACAI,EACAE,EACAK,EACAO,EACAG,EACAE,IAGF,OAAOvD,uBAAY,SAAClD,GAClBC,QAAQC,IAAR,0BAA+BF,EAAM3D,KAArC,OACA,IAAM4K,EAAWN,EAAU3G,EAAM3D,MAC5B4K,EAILA,EAASjH,GAHPC,QAAQC,IAAR,6CAAiDF,EAAM3D,KAAvD,eAID,CAACsK,K,QWhDAO,EAA6B,CACjCC,SAAU,YACVC,UAAW,IACXC,iBAAiB,EACjBC,cAAc,EACdC,cAAc,EACdC,WAAW,EACXC,cAAUrC,GAGCsC,EAAmB,SAAClD,GAE/B,MAA0C9E,qBAA1C,mBAAOiI,EAAP,KAAsBC,EAAtB,KACA,ECrBmC,SAACpD,GAGpC,kBAAwBA,EAAxB,GAAOtF,EAAP,KAAawF,EAAb,KACMmD,EAAqB3E,uBAAY,SAACP,GAClCzD,EAAKyD,UACFA,GACHzD,EAAK0D,SAAS/C,OAAOf,KAAK,CACxBG,QAAS,4BACT5C,KAAM6B,YAAU4J,UAIfnF,GACHzD,EAAK0D,SAAS/C,OAAOf,KAAK,CACxBG,QAAS,iCACT5C,KAAM6B,YAAU6J,QAItBrD,GAAQ,SAAAE,GACN,OAAO,2BACFA,GADL,IAEEjC,mBAGH,IAIH,MAAO,CAFgB4B,EAAkBC,GAEjBqD,GDTqBG,CAAsBxD,GAAnE,mBAAOyD,EAAP,KAAuBJ,EAAvB,KACMK,EAAiBhF,uBAAY,SAAC8C,GAClC,OAAQA,EAAM3J,MACZ,KAAK6B,YAAU+H,YACbkC,IAAUC,KAAKpC,EAAM/G,QAASiI,GAC9B,MAEF,KAAKhJ,YAAU6J,MACbI,IAAUE,MAAMrC,EAAM/G,QAASiI,GAC/B,MAEF,KAAKhJ,YAAU4J,QACbK,IAAUG,KAAKtC,EAAM/G,QAASiI,GAC9B,MAEF,QACEiB,YAAUnC,EAAM/G,QAASiI,MAE5B,IACIhI,EAAP,YAAesF,EAAf,MAEA1E,qBAAU,WAAO,IAAD,MACD,OAAb6H,QAAa,IAAbA,GAAA,UAAAA,EAAeY,cAAf,SAAuBC,cACV,OAAbb,QAAa,IAAbA,GAAA,UAAAA,EAAec,kBAAf,SAA2BD,cACd,OAAbb,QAAa,IAAbA,GAAA,UAAAA,EAAee,cAAf,SAAuBF,cAEvB,IAAMD,EAASrJ,EAAK0D,SAASpD,IAAIO,UAAUkI,GACrCQ,EAAavJ,EAAK0D,SAAS/D,WAAWkB,UAAU8H,GAChDa,EAASxJ,EAAK0D,SAAS/C,OAAOE,UAAUmI,GAQ9C,OANAN,EAAiB,CACfW,SACAE,aACAC,WAGK,WAAO,IAAD,IACE,OAAbf,QAAa,IAAbA,GAAA,UAAAA,EAAeY,cAAf,SAAuBC,cACV,OAAbb,QAAa,IAAbA,GAAA,UAAAA,EAAec,kBAAf,SAA2BD,iBAE5B,CAACP,EAAgBJ,KEhETc,EAAiB,SAACC,GAC7B,MAAwBlJ,qBAAfmJ,EAAT,oBACA3F,uBAAY,WACV2F,EAAY,MACX,CAACD,K,sDCJOlH,EAAYC,YAAWC,YAAa,CAC/CkH,UAAW,CACThH,QAAS,WAEXiH,WAAY,CACVC,SAAU,UAEZC,kBAAmB,CACjBnH,QAAS,cCAAoH,EAAS,SAAC,GAAmC,IAAjCvL,EAAgC,EAAhCA,MAAOD,EAAyB,EAAzBA,MAAOyL,EAAkB,EAAlBA,KAC/BnH,EAASN,IAIf,OAFAiH,EAAe,CAACjL,EAAOyL,IAEnBA,EACK,6BAGF,eAAC7H,EAAA,EAAD,CACLO,WAAS,EACTI,WAAW,SACXE,QAAS,EAHJ,UAIL,cAACb,EAAA,EAAD,CACEe,MAAI,EACJZ,GAAI,EAFN,SAGE,eAAC6C,EAAA,EAAD,CACE8E,MAAM,QACNhH,UAAWJ,EAAO+G,WAFpB,UAGGpL,EAHH,SAMF,cAAC2D,EAAA,EAAD,CACEe,MAAI,EACJZ,GAAI,EACJW,UAAWJ,EAAOiH,kBAHpB,SAIE,cAAC,IAAD,CAEE7E,UAAQ,EACRiF,OAAK,EACLC,IAAK,EACLC,IAAK,EACLC,aAAc9L,EACd0E,UAAWJ,EAAO8G,WAPpB,UACUnL,EADV,YACmBD,EADnB,YAC4B+L,OAAON,OAQrC,cAAC7H,EAAA,EAAD,CACEe,MAAI,EACJZ,GAAI,EAFN,SAGE,cAAC6C,EAAA,EAAD,CACE8E,MAAM,OACNhH,UAAWJ,EAAO+G,WAFpB,SAGGrL,U,QCjDIgE,EAAYC,aAAW,SAAAjB,GAAK,OAAIkB,YAAa,CACxD8H,aAAc,CACZnI,QAAS,OACToI,cAAe,SACfC,eAAgB,UAElBC,oBAAqB,CACnB/H,QAAS,MACTgI,UAAW,OACX,eAAgB,CACdC,cAAe,QAGnBC,YAAa,CACXC,WAAYvJ,EAAMG,QAAQC,QAAQoJ,MAEpCC,iBAAkB,CAChBF,WAAYG,YAAQ1J,EAAMG,QAAQC,QAAQoJ,KAAM,KAElDG,eAAgB,CACdJ,WAAYG,YAAQ1J,EAAMG,QAAQoJ,WAAWK,MAAO,KAEtDC,eAAgB,CACdvB,SAAU,eCZDwB,EAAW,SAAC,GAAqC,IAAD,IAAlClP,EAAkC,EAAlCA,KAAMc,EAA4B,EAA5BA,KAAMjB,EAAsB,EAAtBA,SAE/B6G,EAASN,IAEfiH,EAAe,CAACrN,EAAMc,EAAMjB,IAE5B,IAAMsP,EAAa9J,mBAAQ,kBACxBxF,EAASG,KAAKR,KAAOQ,EAAKR,IACzBsB,EAAKnB,eAAiBgD,eAAayM,OACpCvP,EAASoC,OACZ,CAACpC,EAAUiB,EAAKnB,eAEZ0P,EAAgB3I,EAAO0H,aAQ3B,OANIpO,EAAKR,KAAOK,EAASG,KAAKR,GAC5B6P,GAAa,WAAQxP,EAASoC,KAAOyE,EAAOmI,iBAAmBnI,EAAOgI,aAC7D7O,EAASoC,OAClBoN,GAAa,WAAQ3I,EAAOqI,iBAI5B,cAACO,EAAA,EAAD,CACExI,UAAWuI,EADb,SAEE,cAACE,EAAA,EAAD,CAAazI,UAAWJ,EAAO6H,oBAA/B,SACE,eAACvI,EAAA,EAAD,CACEO,WAAS,EADX,UAEE,cAACP,EAAA,EAAD,CACEO,WAAS,EACTQ,MAAI,EACJyI,aAAa,SACb5I,QAAQ,SACRT,GAAI,EALN,SAME,cAAC6C,EAAA,EAAD,CACE8E,MAAM,OACNhH,UAAWJ,EAAOuI,eAFpB,SAGGpP,EAASkC,SAGd,eAACiE,EAAA,EAAD,CACEO,WAAS,EACTQ,MAAI,EACJZ,GAAI,GAHN,UAIE,cAAC,EAAD,CACE9D,MAAM,SACNwL,KAAMsB,EACN/M,OAAO,UAAAvC,EAASoC,YAAT,eAAeE,SAAU,IAClC,cAAC,EAAD,CACEE,MAAM,QACNwL,KAAMsB,EACN/M,OAAO,UAAAvC,EAASoC,YAAT,eAAeG,QAAS,eCpDhCqN,EAAY,SAAC,GAA2B,IAAzB3O,EAAwB,EAAxBA,KAAMd,EAAkB,EAAlBA,KAIhC,OAFAqN,EAAe,CAACvM,EAAMd,IAGpB,cAACgG,EAAA,EAAD,CACEO,WAAS,EACTI,WAAW,aACXC,QAAQ,aACRC,QAAS,EAJX,SAMI/F,EAAKV,qCAAqCJ,GACvCN,UACAE,KAAI,SAACC,EAAU6P,GAAX,OACH,cAAC1J,EAAA,EAAD,CACEe,MAAI,EAEJZ,GAAI,GAHN,SAIE,cAAC,EAAD,CACEnG,KAAMA,EACNc,KAAMA,EACNjB,SAAUA,KAPd,wBAEwB6P,UCjBvBC,EAAW,SAAC,GAAqB,IAAD,IAAlB/L,EAAkB,EAAlBA,KAEzB,ECDsC,SAACA,GASvC,MAAO,CACLgM,mBATyBhI,uBAAY,WACrChE,EAAK0D,SAAShD,KAAKd,KAAK7B,mCACvB,CAACiC,IAQFiM,oBAN0BjI,uBAAY,WACtChE,EAAK0D,SAAShD,KAAKd,KAAK/B,qCACvB,CAACmC,KDNgDkM,CAAmBlM,GAA/DgM,EAAR,EAAQA,mBAAoBC,EAA5B,EAA4BA,oBAEtBE,EAAU1K,mBAAQ,WAAO,IAAD,IAE5B,OADAV,QAAQC,IAAR,qBAA0BZ,KAAKc,UAAL,UAAelB,EAAK9C,YAApB,aAAe,EAAWpB,gBAChD,UAACkE,EAAK9C,YAAN,aAAC,EAAWpB,YAQF,IAHPkE,EAAK9C,KACTpB,UACAS,QAAO,SAAAN,GAAQ,OAAIA,EAASoC,QAC5B/B,SACF,WAAC0D,EAAK9C,YAAN,aAAC,EAAWpB,YAEf,OACE,eAACsG,EAAA,EAAD,CACEO,WAAS,EADX,UAEE,cAACP,EAAA,EAAD,CACEe,MAAI,EACJZ,GAAI,IACN,cAACH,EAAA,EAAD,CACEe,MAAI,EACJZ,GAAI,EAFN,SAGE,cAACwC,EAAA,EAAD,CACEC,QAAQ,YACRG,QAAS6G,EAFX,qBAMF,cAAC5J,EAAA,EAAD,CACEe,MAAI,EACJZ,GAAI,EAFN,SAGE,cAACwC,EAAA,EAAD,CACEC,QAAQ,YACRE,SAAUiH,IAAW,UAAAnM,EAAK9C,YAAL,eAAWnB,gBAAiBgD,eAAaoI,OAC9DhC,QAAS8G,EAHX,0B,qFEpCKG,GAAwG,WACnH,MCLF,SAAoBC,EAAiBC,EAAcC,GACjD,MAAqC/L,mBAAY6L,GAAjD,mBAAOG,EAAP,KAAcC,EAAd,KAGA,MAAO,CAACD,EAFSE,YAAoBD,EAAqBH,EAAKC,IDGnBI,MAA0CzG,EAAW,IAAI,GAArG,mBAAO0G,EAAP,KAAuBC,EAAvB,KASA,MAAO,CAACD,EAPoB5I,uBAAY,SAAC8I,GACvC,GAAIA,EAAO,CACT,IAAQC,EAAmBD,EAAnBC,OAAQC,EAAWF,EAAXE,OAChBH,EAAkBvO,2BAAiByO,EAAQC,OAE5C,CAACH,MEdOrK,GAAYC,aAAW,SAAAjB,GAAK,OAAIkB,YAAa,CACxDuK,oBAAqB,CACnBC,aAAc,OACdnC,WAAYvJ,EAAMG,QAAQwL,KAAK,WCL7BC,GACC,EADDA,GAEC,EAGMC,IAAeD,GAAmBA,IAAoB,EAEtDE,GAAe,CAACF,GAAkBA,IAElCG,GAAYC,MAAMC,KAAK,CAAEnR,OAAQ8Q,KAAoB,SAACM,EAAG5B,GAAJ,OAAcA,KAC7EvP,QAAO,SAAAiC,GAAK,OAAIA,IAAU6O,MCAhBM,GAAkB,SAAC,GAAwC,IAAtCC,EAAqC,EAArCA,OAAQtQ,EAA6B,EAA7BA,QAASuQ,EAAoB,EAApBA,OACjD,GAAID,GAAUtQ,GAAWA,EAAQ,GAAI,CACnC,IAAMwQ,EAAexQ,EAAQ,GAAGA,QAE1ByQ,EAAgBF,EAAOtR,QAAO,SAAAyR,GAAK,OACvCA,EAAMzP,SAAWuP,EAAavP,QAC9ByP,EAAMxP,QAAUsP,EAAatP,SAC5BxC,KAAI,SAAAgS,GAAK,OAAIA,EAAMvP,SAEtB,GAAIsP,GAAiBA,EAAczR,OAAS,EAAG,CAE7C,IAAM2R,EAAerP,KAAKC,MAAMD,KAAKsP,KAAKH,EAAczR,SAClD6R,EAAiBJ,EAAcK,QAAO,SAACC,EAAK5P,EAAOqN,GAKvD,OAJAuC,GAAO5P,EACHqN,EAAQmC,IAAiB,IAC3BI,GAAO,MAEFA,KAGT,OAAO,qBAAK7J,MAAO,CACjB8J,gBAAiB,QACjBxE,SAAU,SACVyE,cAAe,SACf3L,QAAS,4BACTsK,aAAc,SACdsB,WAAY,YANP,SAQJL,KAIP,OAAO,8BCxCIM,GAAa,SAAC,GAAoC,IAAlC/P,EAAiC,EAAjCA,EAAGC,EAA8B,EAA9BA,EAAG+P,EAA2B,EAA3BA,MAAOlQ,EAAoB,EAApBA,MAExC,MAAiB,kBAANE,GACI,kBAANC,GACU,kBAAV+P,EACA,6BAIP,sBACEhQ,EAAGA,EAAIgQ,EAAQ,EACf/P,EAAGA,EAAI+P,EAAQ,EACfA,MAAOA,EACPC,OAAQD,EACRE,KAAK,OACLC,WAAW,SACX/E,SAAS,SACTgF,iBAAiB,SARnB,SASE,gCACGtQ,O,SCSIuQ,GAAmB,SAAC,GAAqB,IAAD,MAAlB/O,EAAkB,EAAlBA,KAE3BwB,EAAQwN,eACRnB,EC9BiB,SAAC7N,GACxB,OAAOyB,mBAAQ,WAAO,IAAD,EACnB,IAAI,UAAAzB,EAAK9C,YAAL,eAAWpB,YAAakE,EAAK5D,KAAM,CACrC,GAAI4D,EAAK9C,KAAKnB,eAAiBgD,eAAayM,KAM1C,OAAOxL,EAAK9C,KACTpB,UACAS,QAAO,SAAAN,GAAQ,OAAIA,EAASoC,QAC5BrC,KAAI,SAAAC,GAAQ,OAAIA,EAASqC,sBATqB,IAAD,EAC1CrC,EAAQ,UAAG+D,EAAK9C,YAAR,aAAG,EAAWf,mBAAmB6D,EAAK5D,MACpD,UAAIH,QAAJ,IAAIA,OAAJ,EAAIA,EAAUoC,KACZ,MAAO,CAACpC,EAASqC,oBASvB,MAAO,KACN,CAAC0B,EAAK9C,KAAM8C,EAAK5D,ODcL6S,CAAUjP,GACzB,EAA8CoM,KAA9C,mBAAOQ,EAAP,KAAuBsC,EAAvB,KACMC,EEzB0B,SAACnP,GACjC,OAAOgE,uBAAY,SAAC8I,GAA4B,IAAD,EAC7C,GAAIA,GACF9M,EAAK5D,OADH,UAEF4D,EAAK9C,YAFH,aAEF,EAAWpB,YACXkE,EAAK9C,KAAKnB,eAAiBgD,eAAayM,KAAM,CAC9C,IAAQuB,EAAmBD,EAAnBC,OAAQC,EAAWF,EAAXE,OACV3O,EAAOS,qBAAWiO,EAAQC,GAC1B/Q,EAAQ,2BAAQ+D,EAAK/D,UAAb,IAAuBoC,SACrC2B,EAAK0D,SAAShD,KAAKd,KAAKjC,kCAAwB1B,OAEjD,CAAC+D,IFcoBoP,CAAmBpP,GAC3CyJ,EAAe,WAACzJ,EAAK/D,gBAAN,aAAC,EAAeoC,OAC/B,IAAMyE,EAASN,KACT6M,EGlCCrL,uBAAY,SAAC6J,GAClB,IAKMyB,EAAOzB,EAAOO,QAAO,SAACC,EAAKL,GAI/B,OAHAK,EAAI9P,QAAUyP,EAAMzP,OACpB8P,EAAI7P,OAASwP,EAAMxP,MAEZ6P,IATY,CACnB7P,MAAO,EACPD,OAAQ,EACRE,MAAO,SAYT,OAHA6Q,EAAK9Q,OAASqP,EAAOvR,OACrBgT,EAAK/Q,QAAUsP,EAAOvR,OAEf,CAACgT,KACP,IHmBH,OACE,cAACC,EAAA,EAAD,CACEC,OAAQ,IACRd,MAAM,MACNxL,UAAWJ,EAAOmK,oBAHpB,SAIE,eAACwC,EAAA,EAAD,CACEC,OAAQ,CACNC,IAAK,GACLC,OAAQ,GACRC,KAAM,GACNC,MAAO,IAETC,YAAab,EACb/J,QAASgK,EARX,UAUE,cAACa,EAAA,EAAD,CACEC,QAAQ,QACR9S,KAAK,SACL+S,UAAU,EACVjG,MAAM,EACNkG,MAAO5C,GACP6C,OAAQ9C,GACR+C,OAAQ7O,EAAMG,QAAQC,QAAQoJ,OAChC,cAACsF,EAAA,EAAD,CACEL,QAAQ,SACR9S,KAAK,SACL+S,UAAU,EACVjG,MAAM,EACNkG,MAAO5C,GACP6C,OAAQ9C,GACR+C,OAAQ7O,EAAMG,QAAQC,QAAQoJ,OAChC,cAACuF,EAAA,EAAD,CACE7R,EAAG2O,GACHgD,OAAQ7O,EAAMG,QAAQC,QAAQoJ,KAC9BwF,YAAa,EACb/R,MAAO,CACLwJ,SAAU,mBACVzJ,MAAO,SACPoQ,KAAMpN,EAAMG,QAAQC,QAAQoJ,QAjClC,IAoCE,cAACuF,EAAA,EAAD,CACE5R,EAAG0O,GACHgD,OAAQ7O,EAAMG,QAAQC,QAAQoJ,KAC9BwF,YAAa,EACb/R,MAAO,CACLwJ,SAAU,mBACVzJ,MAAO,QACPoQ,KAAMpN,EAAMG,QAAQC,QAAQoJ,QAGhC,cAACyF,GAAA,EAAD,CACEC,gBAAgB,MAChBL,OAAQ7O,EAAMG,QAAQwL,KAAK,OAC7B,cAACwD,GAAA,EAAD,CACE3Q,KAAM6N,EACN+C,mBAAmB,EACnBC,cAAe,EACfL,YAAa,GACb5B,KAAK,OALP,SAME,cAACkC,GAAA,EAAD,CACEb,QAAQ,QACRnG,SAAS,OACTiH,QAAS,cAAC,GAAD,SAGZ,UAAA/Q,EAAK9C,YAAL,eAAWnB,gBAAiBgD,eAAayM,MACxCoB,GACA,cAAC+D,GAAA,EAAD,CACE3Q,KAAM,CAAC4M,GACPoE,MAAM,QACNC,OAAQ,IACRT,YAAa,GACbK,cAAe,GACfK,YAAa,EACbtC,KAAMpN,EAAMG,QAAQG,UAAUkJ,QAEjC,UAAAhL,EAAK9C,YAAL,eAAWnB,gBAAiBgD,eAAaoI,QACxC,cAACwJ,GAAA,EAAD,CACE3Q,KAAMqP,EAAgBxB,GACtBmD,MAAM,QACNC,OAAQ,IACRT,YAAa,GACbK,cAAe,GACfK,YAAa,EACbtC,KAAMpN,EAAMG,QAAQC,QAAQoJ,OAEhC,cAACmG,GAAA,EAAD,CAASJ,QAAS,cAAC,GAAD,CAAiBlD,OAAQA,YIlHtCuD,GAAO,SAAC,GAAsB,IAApBpR,EAAmB,EAAnBA,KAErByJ,EAAe,CAACzJ,EAAK9C,OCFU,SAAC8C,GAEhC,MAAoDQ,qBAApD,mBAAO6Q,EAAP,KAA2BC,EAA3B,KACQC,EAAWC,cAAXD,OAEA9N,EAA8BzD,EAA9ByD,UAAWrH,EAAmB4D,EAAnB5D,KAAMsH,EAAa1D,EAAb0D,SACnBqF,EAAiB/E,uBAAY,SAAClD,GAClC,GAAIA,EAAM3D,OAASC,YAAUC,gBAAiB,CAC5C,IAAMC,EAAUwD,EAAMxD,QAClBlB,GAAQkB,GAAWA,EAAQ2I,QAC7BvC,EAAShD,KAAKd,KAAKnC,6BAAmBrB,EAAMkB,EAAQJ,UAGvD,CAACd,IAEJwE,qBAAU,WACR,GAAI6C,GAAarH,EAOf,OANkB,OAAlBiV,QAAkB,IAAlBA,KAAoB/H,cACpBgI,EAAsB5N,EAASpD,IAAIO,UAAUkI,IAE7CrF,EAAShD,KAAKd,KAAK3C,+BAAqB,CACtCrB,GAAIyI,SAASkN,MAER,yBAAMF,QAAN,IAAMA,OAAN,EAAMA,EAAoB/H,iBAElC,CAAC7F,EAAWrH,EAAMmV,IDtBrBlM,CAAkBrF,GAElB,IAAM5B,EAAYqD,mBAAQ,WAAO,IAAD,EAC9B,IAAI,UAAAzB,EAAK9C,YAAL,eAAWpB,YAAakE,EAAK5D,KAAM,CAAC,IAAD,EAC/BqV,EAAY,UAAGzR,EAAK9C,YAAR,aAAG,EAAWf,mBAAmB6D,EAAK5D,MACxD,OAAmB,OAAZqV,QAAY,IAAZA,OAAA,EAAAA,EAAcrT,aAAa,EAEpC,OAAO,IACN,CAAC4B,IAEJ,OACE,eAACoC,EAAA,EAAD,CACEO,WAAS,EACTU,UAAU,MACVJ,QAAS,EAHX,UAIE,cAACb,EAAA,EAAD,CACEe,MAAI,EACJZ,GAAI,EAFN,SAGE,cAAC,GAAD,CAAkBvC,KAAMA,MAE1B,cAACoC,EAAA,EAAD,CACEe,MAAI,EACJZ,GAAI,EAFN,SAGE,mCAEIvC,EAAK5D,MACL4D,EAAK9C,MACL,cAAC,EAAD,CACEd,KAAM4D,EAAK5D,KACXc,KAAM8C,EAAK9C,WAInB,cAACkF,EAAA,EAAD,CACEe,MAAI,EACJZ,GAAI,GAFN,SAGGnE,GAAa,cAAC,EAAD,CAAU4B,KAAMA,UElDzB0R,GAAQ,kBACnB,cAACtM,EAAA,EAAD,CACEJ,QAAQ,KACRkF,MAAM,SACN1F,MAAO,CACLmN,eAAgB,YAChBC,WAAY,oBALhB,sBCKK,SAASC,KAEd,IAAMC,ECNoB,WAE1B,IAAMpO,EAAWnD,cAEjB,OAAOC,mBAAe,CACpBiD,WAAW,EACXC,aDAgBqO,GAClBvJ,EAAiBsJ,GEA6B,SAAC,GAAgC,IAAD,IAuBvE,EAvByC9R,EAA8B,oBAExE6D,EAAUC,cAEV4F,EAAuB,WAAC1J,EAAK9C,YAAN,aAAC,EAAWtB,GAAIoE,EAAK/D,UAE5C+V,EAAgChO,uBAAY,SAAC1E,GAAwB,IAAD,IAErD,EADnByB,QAAQC,IAAR,sEAAiEhB,EAAK9C,YAAtE,aAAiE,EAAWtB,GAA5E,uBAA6F0D,EAAS2S,YACtG,UAAIjS,EAAK9C,YAAT,aAAI,EAAWtB,MACR0D,EAAS2S,SAASC,MAAM,IAAIC,OAAJ,qBAAenS,EAAK9C,YAApB,aAAe,EAAWtB,QACrDmF,QAAQC,IAAI,4CACZhB,EAAK/D,UAAY+D,EAAK0D,SAAShD,KAAKd,KAAK3B,qCAA2B+B,EAAK/D,eAG5E,WAAC+D,EAAK9C,YAAN,aAAC,EAAWtB,GAAIoE,EAAK/D,WAExB,EAAkEuE,mBAAoC,IAAtG,mBAAO4R,EAAP,KAAkCC,EAAlC,KAEKD,EAA0BrK,UAMzB,UAACqK,EAA0B1I,YAA3B,aAAC,EAAgC4I,OAAM,SAACC,EAASzG,GAAV,OAAoByG,IAAY7I,EAAKoC,SAC9EsG,EAA0BrK,WAC1BsK,EAA6B,CAC3BtK,SAAUlE,EAAQ2O,OAAOR,GACzBtI,KAAMA,KATV2I,EAA6B,CAC3BtK,SAAUlE,EAAQ2O,OAAOR,GACzBtI,KAAMA,IFpBV+I,CAAiCX,GACjC,IAAO9R,EAAP,YAAe8R,EAAf,MAEA,OACE,cAAC,EAAD,UACE,eAAC1P,EAAA,EAAD,CACEO,WAAS,EACTU,UAAU,MACVJ,QAAS,EAHX,UAIE,cAACb,EAAA,EAAD,CACEe,MAAI,EACJZ,GAAI,GAFN,SAGE,cAAC,GAAD,MAEF,cAACH,EAAA,EAAD,CACEe,MAAI,EACJZ,GAAI,GAFN,SAGE,eAAC,IAAD,WACE,cAAC,IAAD,CAAO7G,KAAK,WAAZ,SACE,cAAC,GAAD,CAAMsE,KAAMA,MAEd,cAAC,IAAD,CAAOtE,KAAK,IAAZ,SACE,cAAC,EAAD,CACEsE,KAAMA,gB,OG3BtB0S,iBAKE,eAAC,IAAD,WACE,cAAC,EAAD,UACE,cAACb,GAAD,MAEF,cAAC,IAAD,CACE5J,SAAS,oBAEb0K,SAASC,eAAe,U,+BCpB1B,w5H","file":"static/js/main.31ca52ec.chunk.js","sourcesContent":["const local = {\n  host: 'localhost',\n  port: 8080,\n  path: '/pitanga'\n};\n\nconst production = {\n  host: 'marceloleite2604-pitanga.herokuapp.com',\n  port: 80,\n  path: '/pitanga'\n};\n\nconst config = process.env.REACT_APP_STAGE === 'production' ? production : local;\n\nexport default {\n  ...config\n};\n","import {\n  AttendeeDto,\n  VotingStatus,\n  createAttendee\n} from '.';\nimport { Attendee } from './Attendee';\nimport { User } from './User';\n\nexport interface RoomDto {\n  id: number,\n  attendees: AttendeeDto[],\n  votingStatus: VotingStatus,\n}\n\nexport type Room = Omit<RoomDto, 'attendees'> & {\n  attendees: Attendee[],\n  findAttendeeByUser: (user: User) => Attendee | undefined,\n  removeAttendeeByUserId: (id: string) => Room,\n  sortAttendeesByJoinedAtWithUserFirst: (user: User) => Room\n};\n\nexport const createRoom = ({\n  id,\n  attendees: atts,\n  votingStatus\n} = {} as RoomDto): Room => {\n  const attendees = atts.map(attendee => createAttendee(attendee));\n  return {\n    id,\n    attendees,\n    votingStatus,\n    findAttendeeByUser(user: User): Attendee | undefined {\n      if (this.attendees.length === 0 || !user) {\n        return undefined;\n      }\n    \n      return this.attendees.filter(attendee => attendee.user.id === user.id)[0];\n    },\n    sortAttendeesByJoinedAtWithUserFirst(user: User): Room {\n      const sortedAttendees = [...this.attendees];\n      sortedAttendees.sort((first, second) => {\n        if (first.user.id === user.id) {\n          return -1;\n        }\n    \n        if (second.user.id === user.id) {\n          return 1;\n        }\n    \n        return first.joinedAt - second.joinedAt;\n      });\n      return {\n        ...this,\n        attendees: sortedAttendees\n      };\n    },\n    removeAttendeeByUserId(userId: string): Room {\n      if (this.attendees.length === 0 || !userId) {\n        return { ...this };\n      }\n    \n      return {\n        ...this,\n        attendees: this.attendees.filter(attendee => attendee.user.id !== userId)\n      };\n    }\n  };\n};\n","export interface UserDto {\n  id: string\n}\n\nexport type User = UserDto;\n\nexport const createUser = ({\n  id\n} = {} as UserDto) => ({\n  id\n} as User);\n","export * from './Event';\nexport * from './EventType';\nexport * from './CheckRoomExists';\nexport * from './CreateRoom';\nexport * from './CreateUser';\nexport * from './JoinUser';\nexport * from './MaxRoomsReached';\nexport * from './MaxRoomUsersReached';\nexport * from './MaxUsersReached';\nexport * from './RoomCreated';\nexport * from './UserCreated';\nexport * from './UserDropped';\nexport * from './UserJoined';\nexport * from './AttendeeVoted';\nexport * from './RevealVotes';\nexport * from './ResetRoom';\nexport * from './AttendeeLeftRoom';\n","import { RoomDto } from '..';\nimport { Event } from './Event';\nimport { EventType } from './EventType';\n\nexport interface CheckRoomExistsPayload {\n  room: RoomDto,\n  exists?: boolean\n}\n\nexport interface CheckRoomExistsEvent extends Event<EventType.CheckRoomExists, CheckRoomExistsPayload> { }\n\nexport function buildCheckRoomExists(room: RoomDto) {\n  return {\n    type: EventType.CheckRoomExists,\n    payload: {\n      room\n    }\n  } as CheckRoomExistsEvent;\n}\n","import { UserDto } from '..';\nimport { Event } from './Event';\nimport { EventType } from './EventType';\n\nexport interface CreateRoomPayload {\n  user: UserDto\n}\n\nexport interface CreateRoomEvent extends Event<EventType.CreateRoom, CreateRoomPayload> { }\n\nexport function buildCreateRoomEvent(user: UserDto) {\n  return {\n    type: EventType.CreateRoom,\n    payload: {\n      user\n    }\n  } as CreateRoomEvent;\n}\n","import { UserDto, RoomDto } from '..';\nimport { Event } from './Event';\nimport { EventType } from './EventType';\n\nexport interface JoinUserPayload {\n  room: RoomDto,\n  user: UserDto\n}\n\nexport interface JoinUserEvent extends Event<EventType.JoinUser, JoinUserPayload> { }\n\nexport function buildJoinUserEvent(user: UserDto, room: RoomDto) {\n  return {\n    type: EventType.JoinUser,\n    payload: {\n      user,\n      room\n    }\n  } as JoinUserEvent;\n}\n","import { AttendeeDto } from '..';\nimport { VotingStatus } from '../VotingStatus';\nimport { Event } from './Event';\nimport { EventType } from './EventType';\n\nexport interface AttendeeVotedPayload {\n  attendee: AttendeeDto,\n  votingStatus: VotingStatus\n}\n\nexport interface AttendeeVotedEvent extends Event<EventType.AttendeeVoted, AttendeeVotedPayload> { }\n\nexport function buildAttendeeVotedEvent(attendee: AttendeeDto) {\n  return {\n    type: EventType.AttendeeVoted,\n    payload: {\n      attendee\n    }\n  } as AttendeeVotedEvent;\n}\n","import { Event } from './Event';\nimport { EventType } from './EventType';\n\nexport interface RevealVotesEvent extends Event<EventType.RevealVotes> { }\n\nexport function buildRevealVotesEvent() {\n  return {\n    type: EventType.RevealVotes\n  } as RevealVotesEvent;\n}\n","import { RoomDto } from '..';\nimport { Event } from './Event';\nimport { EventType } from './EventType';\n\nexport interface ResetRoomPayload {\n  room: RoomDto\n}\n\nexport interface ResetRoomEvent extends Event<EventType.ResetRoom, ResetRoomPayload> {\n}\n\nexport function buildResetRoomEvent() {\n  return {\n    type: EventType.ResetRoom\n  } as ResetRoomEvent;\n}\n","import { AttendeeDto } from '..';\nimport { Event } from './Event';\nimport { EventType } from './EventType';\n\nexport interface AttendeeLeftRoomPayload {\n  attendee: AttendeeDto,\n  newRoomOwner?: AttendeeDto\n}\n\nexport interface AttendeeLeftRoomEvent extends Event<EventType.AttendeeLeftRoom, AttendeeLeftRoomPayload> { }\n\nexport function buildAttendeeLeftRoomEvent(attendee: AttendeeDto) {\n  return {\n    type: EventType.AttendeeLeftRoom,\n    payload: {\n      attendee\n    }\n  } as AttendeeLeftRoomEvent;\n}\n","import {\n  ChartPoint,\n  UserDto,\n  User,\n  Vote,\n  createUser\n} from '.';\n\nexport interface AttendeeDto {\n  user: UserDto,\n  icon: string,\n  joinedAt: number,\n  roomOwner: boolean\n  vote?: Vote,\n}\n\nexport type Attendee = Omit<AttendeeDto, 'user'> & {\n  user: User\n  createChartPoint: () => ChartPoint\n}\n\nexport const createAttendee = ({\n  user,\n  icon,\n  joinedAt,\n  roomOwner,\n  vote\n} = {} as AttendeeDto) => ({\n  user: createUser(user),\n  icon,\n  joinedAt,\n  roomOwner,\n  vote,\n  createChartPoint(): ChartPoint {\n    return {\n      effort: this.vote?.effort || 0,\n      value: this.vote?.value || 0,\n      label: this.icon\n    };\n  }\n} as Attendee);\n","export interface ChartPoint {\n  value: number,\n  effort: number,\n  label: string,\n}\n\nexport const createChartPoint = (x: number, y: number, label?: string) => ({\n  value: Math.round(x),\n  effort: Math.round(y),\n  label\n} as ChartPoint);\n","export interface VoteDto {\n  effort: number,\n  value: number\n}\n\nexport type Vote = VoteDto;\n\nexport const createVote = (x: number, y: number) => ({\n  value: Math.round(x),\n  effort: Math.round(y)\n} as Vote);\n","export enum VotingStatus {\n  Open = 'open',\n  Closed = 'closed'\n}\n","export enum ToastType {\n  INFORMATION = 'info',\n  SUCCESS = 'success',\n  WARNING = 'warn',\n  ERROR = 'error'\n}\n\nexport interface Toast {\n  message: string,\n  type?: ToastType\n}\n","import { useEffect, useState } from 'react';\nimport { Subject } from 'rxjs';\nimport { w3cwebsocket as W3CWebSocket } from 'websocket';\nimport configuration from '../../config';\nimport { Event, WebSocketSubjects, Toast } from '../../shared/model';\n\nfunction elaborateWebsocketUri() {\n  const schema = location.protocol === 'https:' ? 'wss:' : 'ws:';\n  const port = location.protocol === 'https:' ? configuration.port : 443;\n  return `${schema}//${configuration.host}:${port}${configuration.path}`;\n}\n\nfunction createClient(webSocketSubjects: WebSocketSubjects) {\n  const client = new W3CWebSocket(elaborateWebsocketUri());\n  client.onopen = () => {\n    webSocketSubjects.$connected.next(true);\n  };\n\n  client.onclose = () => {\n    webSocketSubjects.$connected.next(false);\n  };\n\n  client.onmessage = (message) => {\n    if (message.data instanceof Buffer || message.data instanceof ArrayBuffer) {\n      throw new Error('Unsuported message data type.');\n    }\n\n    const data = JSON.parse(message.data) as Event;\n    webSocketSubjects.$in.next(data);\n  };\n\n  return client;\n}\n\nexport const useWebSocketSubjects = () => {\n\n  const [webSocketSubjects] = useState<WebSocketSubjects>({\n    $connected: new Subject<boolean>(),\n    $in: new Subject<Event>(),\n    $out: new Subject<Event>(),\n    $toast: new Subject<Toast>()\n  });\n\n  const [client] = useState(() => createClient(webSocketSubjects));\n\n  useEffect(() => {\n    webSocketSubjects.$out.subscribe(event => {\n      console.log(`Sending event \"${event.type}\"`);\n      client.send(JSON.stringify(event));\n    });\n  }, []);\n\n  return webSocketSubjects;\n};\n","export enum EventType {\n  CreateUser = 'create-user',\n  UserCreated = 'user-created',\n  MaxUsersReached = 'max-users-reached',\n  JoinUser = 'join-user',\n  UserJoined = 'user-joined',\n  MaxRoomUsersReached = 'max-room-users-reached',\n  CreateRoom = 'create-room',\n  RoomCreated = 'room-created',\n  MaxRoomsReached = 'max-rooms-reached',\n  CheckRoomExists = 'check-room-exists',\n  UserDropped = 'user-dropped',\n  AttendeeVoted = 'attendee-voted',\n  ResetRoom = 'reset-room',\n  RevealVotes = 'reveal-votes',\n  AttendeeLeftRoom = 'attendee-left-room'\n}\n","import { FC } from 'react';\nimport { ThemeProvider, useMediaQuery, CssBaseline } from '@material-ui/core';\nimport { useTheme } from './hooks';\n\nexport const ThemeController: FC = ({ children }) => {\n  const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)');\n  const theme = useTheme(prefersDarkMode);\n\n  return (\n    <ThemeProvider theme={theme}>\n      <CssBaseline />\n      {children}\n    </ThemeProvider>\n  );\n};\n","import { useMemo } from 'react';\nimport { createMuiTheme } from '@material-ui/core';\n\nexport const useTheme = (darkMode: boolean) => {\n  return useMemo(() => createMuiTheme({\n    palette: {\n      type: darkMode ? 'dark' : 'light',\n      primary: {\n        main: '#9fdc93'\n      },\n      secondary: {\n        main: '#C0A287'\n      }\n    }\n  }), [darkMode]);\n};\n","import { Box, Grid } from '@material-ui/core';\n\nexport const BoxMargin = () =>\n  <Box\n    component={Grid}\n    display={{\n      md: 'block',\n      xs: 'none'\n    }} />;\n","import { createStyles, makeStyles } from '@material-ui/styles';\n\nexport const useStyles = makeStyles(createStyles({\n  container: {\n    padding: '2vh 2vw'\n  }\n}));\n","import { Grid } from '@material-ui/core';\nimport { FC } from 'react';\nimport { BoxMargin } from './BoxMargin';\nimport { useStyles } from './hooks';\n\nexport const Container: FC = ({ children }) => {\n\n  const styles = useStyles();\n\n  return <Grid\n    container\n    alignItems='center'\n    justify='center'\n    spacing={0}\n    className={styles.container} >\n    <BoxMargin />\n    <Grid\n      item\n      md={10}\n      xs={12}>\n      {children}\n    </Grid>\n    <BoxMargin />\n  </Grid >;\n};\n","import { FC } from 'react';\nimport { Grid, GridSize, GridItemsAlignment } from '@material-ui/core';\n\ninterface Params {\n  xs?: boolean | GridSize,\n  alignItems?: GridItemsAlignment\n}\n\nexport const GridItem : FC<Params> = ({ xs, alignItems, children }) => {\n\n  return (\n    <Grid\n      container\n      item\n      xs={xs}\n      direction='column'\n      justify='flex-start'\n      alignItems={alignItems || 'center'}>\n      {children}\n    </Grid>\n  );\n};\n","import { createStyles, makeStyles } from '@material-ui/styles';\n\nexport const useStyles = makeStyles(createStyles({\n  joinRooomButton: {\n    marginTop: '16px'\n  }\n}));\n","import { useCallback, useState } from 'react';\nimport { useHistory } from 'react-router';\nimport { Button, TextField, Grid, Typography } from '@material-ui/core';\nimport { buildCreateRoomEvent, Data } from '../../shared/model';\nimport { GridItem } from './GridItem';\nimport { useStyles } from './hooks';\n\ninterface Params {\n  data: Data\n}\n\nexport const Home = ({ data }: Params) => {\n\n  const { connected, user, subjects } = data;\n  const [roomNumber, setRoomNumber] = useState<string>();\n\n  const history = useHistory();\n  \n  const joinRoom = useCallback(() => {\n    history.push(`${roomNumber}`);\n  }, [history, roomNumber]);\n\n  const sendCreateRoomEvent = () => {\n    user && subjects.$out.next(buildCreateRoomEvent(user));\n  };\n\n  const validateRoomNumber = useCallback((roomNum?: string) => {\n\n    if (!roomNum) {\n      return false;\n    }\n\n    if (roomNum.length !== 8) {\n      return false;\n    }\n\n    if (isNaN(parseInt(roomNum))) {\n      return false;\n    }\n\n    return true;\n  }, []);\n\n  const classes = useStyles();\n\n  const joinRoomButtonDisabled = !connected || !user || !validateRoomNumber(roomNumber);\n\n  return (\n    <Grid\n      container\n      spacing={2}\n      alignItems='center'\n      style={{ flexGrow: 0 }}>\n      <GridItem\n        xs={6}\n        alignItems='flex-end'>\n        <TextField\n          id='roomNumber'\n          label='Room number'\n          inputProps={{\n            maxLength: '8'\n          }}\n          onChange={event => setRoomNumber(event.target.value)} />\n      </GridItem>\n      <GridItem\n        xs={6}\n        alignItems='flex-start'>\n        <Button\n          variant='contained'\n          color='primary'\n          disabled={joinRoomButtonDisabled}\n          onClick={joinRoom}\n          className={classes.joinRooomButton}>Join Room</Button>\n      </GridItem>\n      <GridItem xs={12}>\n        <Typography>Or</Typography>\n      </GridItem>\n      <GridItem xs={12}>\n        <Button\n          variant='contained'\n          color='primary'\n          disabled={!connected || !user}\n          onClick={sendCreateRoomEvent}>Create room</Button>\n      </GridItem>\n    </Grid >\n  );\n};\n","import { useCallback, useMemo } from 'react';\nimport { EventType, Event } from '../../../shared/model';\nimport { CallbackHookParams, EventCallback } from '../types';\nimport { useAttendeeVotedCallback } from './useAttendeeVotedCallback';\nimport { useRoomCreatedCallback } from './useRoomCreatedCallback';\nimport { useUserCreatedCallback } from './useUserCreatedCallback';\nimport { useCheckRoomExistsCallback } from './useCheckRoomExistsCallback';\nimport { useMaxUsersReachedCallback } from './useMaxUsersReachedCallback';\nimport { useResetRoomCallback } from './useResetRoomCallback';\nimport { useRevealVotesCallback } from './useRevealVotesCallback';\nimport { useUserDroppedCallback } from './useUserDroppedCallback';\nimport { useUserJoinedCallback } from './useUserJoinedCallback';\nimport { useAttendeeLeftRoomCallback } from './useAttendeeLeftRoomCallback';\n\ntype EventsCallbacks = { [key in EventType]?: EventCallback<any> };\n\nexport const useEventsCallback = (params: CallbackHookParams) => {\n  const attendeeVotedCallback = useAttendeeVotedCallback(params);\n  const roomCreatedCallback = useRoomCreatedCallback(params);\n  const userCreatedCallback = useUserCreatedCallback(params);\n  const checkRoomExistsCallback = useCheckRoomExistsCallback(params);\n  const maxUsersReachedCallback = useMaxUsersReachedCallback(params);\n  const userJoinedCallback = useUserJoinedCallback(params);\n  const userDroppedCallback = useUserDroppedCallback(params);\n  const revealVotesCallback = useRevealVotesCallback(params);\n  const resetRoomCallback = useResetRoomCallback(params);\n  const attendeeLeftRoomEventCallback = useAttendeeLeftRoomCallback(params);\n\n  const callbacks = useMemo(() => {\n    return {\n      [EventType.UserCreated]: userCreatedCallback,\n      [EventType.CheckRoomExists]: checkRoomExistsCallback,\n      [EventType.AttendeeVoted]: attendeeVotedCallback,\n      [EventType.RoomCreated]: roomCreatedCallback,\n      [EventType.ResetRoom]: resetRoomCallback,\n      [EventType.RevealVotes]: revealVotesCallback,\n      [EventType.UserDropped]: userDroppedCallback,\n      [EventType.UserJoined]: userJoinedCallback,\n      [EventType.MaxUsersReached]: maxUsersReachedCallback,\n      [EventType.AttendeeLeftRoom]: attendeeLeftRoomEventCallback\n    } as EventsCallbacks;\n  }, [attendeeVotedCallback,\n    roomCreatedCallback,\n    userCreatedCallback,\n    checkRoomExistsCallback,\n    maxUsersReachedCallback,\n    userJoinedCallback,\n    userDroppedCallback,\n    revealVotesCallback,\n    resetRoomCallback,\n    attendeeLeftRoomEventCallback\n  ]);\n\n  return useCallback((event: Event) => {\n    console.log(`Received event \"${event.type}\".`);\n    const callback = callbacks[event.type];\n    if (!callback) {\n      console.log(`[ERROR] Don't know how to handle \"${event.type}\" event.`);\n      return;\n    }\n    callback(event);\n  }, [callbacks]);\n};\n","import { useCallback } from 'react';\nimport { AttendeeVotedEvent, createAttendee } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useAttendeeVotedCallback = ([data, setData]: CallbackHookParams) => {\n  return useCallback((event: AttendeeVotedEvent) => {\n    if (data.room?.attendees && event.payload) {\n      const votingAttendee = createAttendee(event.payload.attendee);\n      const room = data.room.removeAttendeeByUserId(votingAttendee.user.id);\n      room.attendees.push(votingAttendee);\n      room.votingStatus = event.payload.votingStatus;\n      setData(previousState => {\n        return {\n          ...previousState,\n          room\n        };\n      });\n    }\n  }, [data.room]);\n};\n","import { useCallback } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport {\n  createAttendee,\n  createRoom,\n  RoomCreatedEvent\n} from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useRoomCreatedCallback = ([, setData]: CallbackHookParams) => {\n  const history = useHistory();\n  return useCallback((event: RoomCreatedEvent) => {\n    if (event.payload) {\n      setData(previousState => {\n        return {\n          ...previousState,\n          room: createRoom(event.payload?.room),\n          attendee: createAttendee(event.payload?.room.attendees[0])\n        };\n      });\n      history.push(`/${event.payload.room.id}`);\n    }\n  }, [history]);\n};\n","import { useCallback } from 'react';\nimport { UserCreatedEvent } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useUserCreatedCallback = ([, setData]: CallbackHookParams) => {\n  return useCallback((event: UserCreatedEvent) => {\n    if (event.payload) {\n      setData(previousState => {\n        return {\n          ...previousState,\n          user: event.payload?.user\n        };\n      });\n    }\n  }, []);\n};\n","import { useCallback } from 'react';\nimport { useHistory } from 'react-router';\nimport { CheckRoomExistsEvent, createRoom } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useCheckRoomExistsCallback = ([data, setData]: CallbackHookParams) => {\n  const history = useHistory();\n  return useCallback((event: CheckRoomExistsEvent) => {\n    if (event.payload) {\n      if (!event.payload.exists) {\n        setData(previousState => {\n          return {\n            ...previousState,\n            room: undefined\n          };\n        });\n        history.push('/');\n      } else {\n        const room = createRoom(event.payload.room);\n        setData(previousState => {\n          return {\n            ...previousState,\n            room\n          };\n        });\n      }\n    }\n  }, [history, data.room]);\n};\n","import { useCallback } from 'react';\nimport { CallbackHookParams } from '../types';\n\nexport const useMaxUsersReachedCallback = ([data]: CallbackHookParams) => {\n  return useCallback(() => {\n    data.subjects.$connected.next(false);\n  }, []);\n};\n","import { useCallback } from 'react';\nimport {\n  createAttendee,\n  createRoom,\n  UserJoinedEvent\n} from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useUserJoinedCallback = ([data, setData]: CallbackHookParams) => {\n  return useCallback((event: UserJoinedEvent) => {\n    if (data.room && event.payload && data.room.id === event.payload.room.id) {\n      setData(previousState => {\n        return {\n          ...previousState,\n          room: createRoom(event.payload?.room)\n        };\n      });\n      if (!data.attendee) {\n        const roomAttendee = event.payload.room.attendees.find(att => att?.user.id === data.user?.id);\n        if (roomAttendee) {\n          setData(previousState => {\n            return {\n              ...previousState,\n              attendee: createAttendee(roomAttendee)\n            };\n          });\n        }\n      }\n    }\n  }, [data.room, data.attendee, data.user]);\n};\n","import { useCallback } from 'react';\nimport { Room, Toast, ToastType, UserDroppedEvent } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useUserDroppedCallback = ([data, setData]: CallbackHookParams) => {\n  return useCallback((event: UserDroppedEvent) => {\n    if (data.room && event.payload) {\n      const droppedAttendee = data.room.attendees\n        .find(attendee => attendee.user.id === event.payload?.user.id);\n\n      const remainingAttendees = data.room.attendees\n        .filter(attendee => attendee !== droppedAttendee);\n\n      const toast: Toast = {\n        message: `${droppedAttendee?.icon} dropped.`,\n        type: ToastType.INFORMATION\n      };\n\n      if (event.payload.newRoomOwner) {\n        debugger;\n        const newRoomOwner = remainingAttendees.find(attendee => attendee.user.id === event.payload?.newRoomOwner?.user.id);\n        if (newRoomOwner) {\n          newRoomOwner.roomOwner = true;\n\n          toast.message = `${toast.message} New room owner is ${newRoomOwner?.icon}.`;\n        }\n      }\n\n      data.subjects.$toast.next(toast);\n\n      setData(previousState => {\n        return {\n          ...previousState,\n          room: {\n            ...previousState.room,\n            attendees: remainingAttendees\n          } as Room\n        };\n      });\n    }\n  }, [data.room]);\n};\n","import { useCallback } from 'react';\nimport { Room, VotingStatus } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useRevealVotesCallback = ([, setData]: CallbackHookParams) => {\n  return useCallback(() => {\n    setData(previousState => {\n      return {\n        ...previousState,\n        room: {\n          ...previousState.room,\n          votingStatus: VotingStatus.Closed\n        } as Room\n      };\n    });\n  }, []);\n};\n","import { useCallback } from 'react';\nimport { createRoom, ResetRoomEvent } from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useResetRoomCallback = ([, setData]: CallbackHookParams) => {\n  return useCallback((event: ResetRoomEvent) => {\n    if (event.payload) {\n      const room = createRoom(event.payload.room);\n      setData(previousState => {\n        return {\n          ...previousState,\n          room\n        };\n      });\n    }\n  }, []);\n};\n","import { useCallback } from 'react';\nimport {\n  AttendeeLeftRoomEvent,\n  Toast,\n  ToastType,\n  createAttendee\n} from '../../../shared/model';\nimport { CallbackHookParams } from '../types';\n\nexport const useAttendeeLeftRoomCallback = ([data, setData]: CallbackHookParams) => {\n  return useCallback((event: AttendeeLeftRoomEvent) => {\n    if (event.payload) {\n      /* User is the actual attendee. */\n      if (data.attendee && data.attendee.user.id === event.payload.attendee.user.id) {\n        setData(previousState => {\n          return {\n            ...previousState,\n            room: undefined,\n            attendee: undefined\n          };\n        });\n      } else {\n        debugger;\n        if (data.room?.attendees) {\n          let room = data.room.removeAttendeeByUserId(event.payload.attendee.user.id);\n          if (event.payload.newRoomOwner) {\n            const newRoomOwner = createAttendee(event.payload.newRoomOwner);\n            room = room.removeAttendeeByUserId(event.payload.newRoomOwner.user.id);\n            room.attendees.push(newRoomOwner);\n            const toast: Toast = {\n              message: `${event.payload.attendee.icon} left. New room owner is ${event.payload.newRoomOwner.icon}.`,\n              type: ToastType.INFORMATION\n            };\n            data.subjects.$toast.next(toast);\n          }\n          setData(previousState => {\n            return {\n              ...previousState,\n              room\n            };\n          });\n        }\n      }\n    }\n  }, [data.attendee, data.room]);\n};\n","import { useCallback, useEffect, useState } from 'react';\nimport { Subscription } from 'rxjs';\nimport { useWebSocketCallbacks } from './useWebSocketCallbacks';\nimport { CallbackHookParams } from './types';\nimport { toast as showToast, ToastOptions } from 'react-toastify';\nimport { Toast, ToastType } from '../../shared/model';\n\ninterface Subscriptions {\n  connection?: Subscription,\n  events?: Subscription,\n  toasts?: Subscription\n}\n\nconst toastOptions: ToastOptions = {\n  position: 'top-right',\n  autoClose: 3000,\n  hideProgressBar: false,\n  closeOnClick: true,\n  pauseOnHover: true,\n  draggable: false,\n  progress: undefined\n};\n\nexport const useSubscriptions = (params: CallbackHookParams) => {\n\n  const [subscriptions, setSubscriptions] = useState<Subscriptions>();\n  const [eventsCallback, connectionCallback] = useWebSocketCallbacks(params);\n  const toastsCallback = useCallback((toast: Toast) => {\n    switch (toast.type) {\n      case ToastType.INFORMATION: {\n        showToast.info(toast.message, toastOptions);\n        break;\n      }\n      case ToastType.ERROR: {\n        showToast.error(toast.message, toastOptions);\n        break;\n      }\n      case ToastType.WARNING: {\n        showToast.warn(toast.message, toastOptions);\n        break;\n      }\n      default:\n        showToast(toast.message, toastOptions);\n    }\n  }, []);\n  const [data] = params;\n\n  useEffect(() => {\n    subscriptions?.events?.unsubscribe();\n    subscriptions?.connection?.unsubscribe();\n    subscriptions?.toasts?.unsubscribe();\n\n    const events = data.subjects.$in.subscribe(eventsCallback);\n    const connection = data.subjects.$connected.subscribe(connectionCallback);\n    const toasts = data.subjects.$toast.subscribe(toastsCallback);\n\n    setSubscriptions({\n      events,\n      connection,\n      toasts\n    });\n\n    return () => {\n      subscriptions?.events?.unsubscribe();\n      subscriptions?.connection?.unsubscribe();\n    };\n  }, [eventsCallback, connectionCallback]);\n};\n","import { useCallback } from 'react';\nimport { Event, ToastType } from '../../shared/model';\nimport { useEventsCallback } from './events-callback';\nimport { CallbackHookParams } from './types';\n\nexport const useWebSocketCallbacks = (params: CallbackHookParams):\n[(event: Event) => void, (conn: boolean) => void] => {\n\n  const [data, setData] = params;\n  const connectionCallback = useCallback((connected: boolean) => {\n    if (data.connected) {\n      if (!connected) {\n        data.subjects.$toast.next({\n          message: 'Disconnected from server.',\n          type: ToastType.WARNING\n        });\n      }\n    } else {\n      if (!connected) {\n        data.subjects.$toast.next({\n          message: 'Could not connect with server.',\n          type: ToastType.ERROR\n        });\n      }\n    }\n    setData(previousState => {\n      return {\n        ...previousState,\n        connected\n      };\n    });\n  }, []);\n\n  const eventsCallback = useEventsCallback(params);\n\n  return [eventsCallback, connectionCallback];\n};\n","import { DependencyList, useCallback, useState } from 'react';\n\nexport const useUpdateState = (deps: DependencyList) => {\n  const [, updateState] = useState<Object>();\n  useCallback(() => {\n    updateState({});\n  }, [deps]);\n};\n","import { makeStyles, createStyles } from '@material-ui/core';\n\nexport const useStyles = makeStyles(createStyles({\n  muiSlider: {\n    padding: '4px 0px'\n  },\n  typography: {\n    fontSize: '0.8rem'\n  },\n  muiSliderGridItem: {\n    padding: '4px 0px'\n  }\n}));\n","import { Grid, Slider as MuiSlider, Typography } from '@material-ui/core';\nimport { useUpdateState } from '../../../../../shared/hooks';\nimport { useStyles } from './hooks';\n\ninterface Props {\n  label: string,\n  value: number,\n  hide?: boolean\n}\n\nexport const Slider = ({ label, value, hide }: Props) => {\n  const styles = useStyles();\n\n  useUpdateState([value, hide]);\n\n  if (hide) {\n    return <></>;\n  }\n\n  return <Grid\n    container\n    alignItems='center'\n    spacing={2}>\n    <Grid\n      item\n      xs={3}>\n      <Typography\n        align='right'\n        className={styles.typography}>\n        {label}:\n      </Typography>\n    </Grid>\n    <Grid\n      item\n      xs={7}\n      className={styles.muiSliderGridItem}>\n      <MuiSlider\n        key={`${label}-${value}-${String(hide)}`}\n        disabled\n        marks\n        min={0}\n        max={6}\n        defaultValue={value}\n        className={styles.muiSlider} />\n    </Grid>\n    <Grid\n      item\n      xs={2}>\n      <Typography\n        align='left'\n        className={styles.typography} >\n        {value}\n      </Typography>\n    </Grid>\n  </Grid>;\n};\n","import { makeStyles, createStyles, lighten } from '@material-ui/core/styles';\n\nexport const useStyles = makeStyles(theme => createStyles({\n  attendeeCard: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center'\n  },\n  attendeeCardContent: {\n    padding: '4px',\n    minHeight: '48px',\n    '&:last-child': {\n      paddingBottom: '4px'\n    }\n  },\n  currentUser: {\n    background: theme.palette.primary.dark\n  },\n  currentUserVoted: {\n    background: lighten(theme.palette.primary.dark, 0.2)\n  },\n  otherUserVoted: {\n    background: lighten(theme.palette.background.paper, 0.2)\n  },\n  iconTypography: {\n    fontSize: '1.5rem'\n  }\n}));\n","import { useMemo } from 'react';\nimport { Card, CardContent, Grid, Typography } from '@material-ui/core';\nimport { Attendee as AttendeeModel, Room, User, VotingStatus } from '../../../../shared/model';\nimport { useUpdateState } from '../../../../shared/hooks';\nimport { Slider } from './slider';\nimport { useStyles } from './hooks';\n\ninterface Props {\n  user: User,\n  room: Room,\n  attendee: AttendeeModel\n}\n\nexport const Attendee = ({ user, room, attendee }: Props) => {\n\n  const styles = useStyles();\n\n  useUpdateState([user, room, attendee]);\n\n  const hideSlider = useMemo(() =>\n    (attendee.user.id !== user.id &&\n      room.votingStatus === VotingStatus.Open) ||\n    !attendee.vote,\n  [attendee, room.votingStatus]);\n\n  let cardClassName = styles.attendeeCard;\n\n  if (user.id === attendee.user.id) {\n    cardClassName += ` ${attendee.vote ? styles.currentUserVoted : styles.currentUser}`;\n  } else if (attendee.vote) {\n    cardClassName += ` ${styles.otherUserVoted}`;\n  }\n\n  return (\n    <Card\n      className={cardClassName} >\n      <CardContent className={styles.attendeeCardContent}>\n        <Grid\n          container>\n          <Grid\n            container\n            item\n            alignContent='center'\n            justify='center'\n            xs={2}>\n            <Typography\n              align='left'\n              className={styles.iconTypography} >\n              {attendee.icon}\n            </Typography>\n          </Grid>\n          <Grid\n            container\n            item\n            xs={10}>\n            <Slider\n              label='Effort'\n              hide={hideSlider}\n              value={attendee.vote?.effort || 0} />\n            <Slider\n              label='Value'\n              hide={hideSlider}\n              value={attendee.vote?.value || 0} />\n          </Grid>\n        </Grid>\n      </CardContent>\n    </Card>\n  );\n};\n","import { Grid } from '@material-ui/core';\nimport { useUpdateState } from '../../../shared/hooks';\nimport { User, Room } from '../../../shared/model';\nimport { Attendee } from './attendee';\n\ninterface Props {\n  room: Room,\n  user: User\n}\n\nexport const Attendees = ({ room, user }: Props) => {\n\n  useUpdateState([room, user]);\n\n  return (\n    <Grid\n      container\n      alignItems='flex-start'\n      justify='flex-start'\n      spacing={1} >\n      {\n        room.sortAttendeesByJoinedAtWithUserFirst(user)\n          .attendees\n          .map((attendee, index) =>\n            <Grid\n              item\n              key={`attendee-grid-${index}`}\n              xs={12}>\n              <Attendee\n                user={user}\n                room={room}\n                attendee={attendee} />\n            </Grid>)\n      }\n    </Grid >\n  );\n};\n","import { Button, Grid } from '@material-ui/core';\nimport { useMemo } from 'react';\nimport { Data, VotingStatus } from '../../../shared/model';\nimport { useButtonsCallback } from './hooks';\n\ninterface Props {\n  data: Data\n}\n\nexport const Controls = ({ data }: Props) => {\n\n  const { onResetButtonClick, onRevealButtonClick } = useButtonsCallback(data);\n\n  const noVotes = useMemo(() => {\n    console.log(`Attendees: ${JSON.stringify(data.room?.attendees)}`);\n    if (!data.room?.attendees) {\n      return false;\n    }\n\n    debugger;\n    return data.room\n      .attendees\n      .filter(attendee => attendee.vote)\n      .length === 0;\n  }, [data.room?.attendees]);\n\n  return (\n    <Grid\n      container>\n      <Grid\n        item\n        xs={2} />\n      <Grid\n        item\n        xs={2}>\n        <Button\n          variant='contained'\n          onClick={onResetButtonClick}>\n          Reset\n        </Button>\n      </Grid>\n      <Grid\n        item\n        xs={2}>\n        <Button\n          variant='contained'\n          disabled={noVotes || data.room?.votingStatus === VotingStatus.Closed}\n          onClick={onRevealButtonClick}>\n          Reveal\n        </Button>\n      </Grid>\n    </Grid>\n  );\n};\n","import { useCallback } from 'react';\nimport { buildResetRoomEvent, buildRevealVotesEvent, Data } from '../../../../shared/model';\n\ninterface Return {\n  onResetButtonClick: () => void,\n  onRevealButtonClick: () => void\n}\n\ntype Hook = (data: Data) => Return;\n\nexport const useButtonsCallback: Hook = (data) => {\n  const onResetButtonClick = useCallback(() => {\n    data.subjects.$out.next(buildResetRoomEvent());\n  }, [data]);\n\n  const onRevealButtonClick = useCallback(() => {\n    data.subjects.$out.next(buildRevealVotesEvent());\n  }, [data]);\n\n  return {\n    onResetButtonClick,\n    onRevealButtonClick\n  };\n};\n","import { useCallback } from 'react';\nimport {\n  ChartPoint,\n  ChartEventProps,\n  createChartPoint\n} from '../../../../shared/model';\nimport { useThrottledState } from '../../../../shared/hooks';\n\nexport const useOnMouseMoveCallback: () => [ChartPoint | undefined, (props?: ChartEventProps | undefined) => void] = () => {\n  const [suggestedPoint, setSuggestedPoint] = useThrottledState<ChartPoint | undefined>(undefined, 30, true);\n\n  const onMouseMoveCallback = useCallback((props?: ChartEventProps) => {\n    if (props) {\n      const { xValue, yValue } = props;\n      setSuggestedPoint(createChartPoint(xValue, yValue));\n    }\n  }, [setSuggestedPoint]);\n\n  return [suggestedPoint, onMouseMoveCallback];\n};\n","import { useThrottleCallback } from '@react-hook/throttle';\nimport { SetStateAction, useState } from 'react';\n\nexport const useThrottledState: <T extends unknown>(initialState: T, fps?: number, leading?: boolean) => [T, (value: SetStateAction<T>) => void] =\n<T extends unknown>(initialState: T, fps?: number, leading?: boolean) => {\n  const [state, unthrottledSetState] = useState<T>(initialState);\n  const setState = useThrottleCallback(unthrottledSetState, fps, leading);\n\n  return [state, setState];\n};\n","import { createStyles, makeStyles } from '@material-ui/core/styles';\n\nexport const useStyles = makeStyles(theme => createStyles({\n  responsiveContainer: {\n    borderRadius: '10px',\n    background: theme.palette.grey[800]\n  }\n}));\n","const domainValues = {\n  min: 0,\n  max: 6\n};\n\nexport const mediumPoint = (domainValues.min + domainValues.max) / 2;\n\nexport const domainLimits = [domainValues.min, domainValues.max];\n\nexport const axisTicks = Array.from({ length: domainValues.max }, (_, index) => index)\n  .filter(value => value !== mediumPoint);\n","import { TooltipProps } from 'recharts';\nimport { NameType, ValueType } from 'recharts/types/component/DefaultTooltipContent';\nimport { ChartPoint } from '../../../shared/model';\n\ninterface ExtraProps {\n  points: ChartPoint[]\n}\n\ntype Props = TooltipProps<ValueType, NameType> & ExtraProps;\n\nexport const TooltipRenderer = ({ active, payload, points }: Props) => {\n  if (active && payload && payload[0]) {\n    const hoveredPoint = payload[0].payload as ChartPoint;\n\n    const hoveredLabels = points.filter(point =>\n      point.effort === hoveredPoint.effort &&\n      point.value === hoveredPoint.value)\n      .map(point => point.label);\n\n    if (hoveredLabels && hoveredLabels.length > 1) {\n\n      const itemsPerLine = Math.round(Math.sqrt(hoveredLabels.length));\n      const tooltipContent = hoveredLabels.reduce((acc, label, index) => {\n        acc += label;\n        if (index % itemsPerLine === 0) {\n          acc += '\\n';\n        }\n        return acc;\n      });\n\n      return <div style={{\n        backgroundColor: '#0008',\n        fontSize: '0.8rem',\n        letterSpacing: '0.5rem',\n        padding: '0.5rem 0rem 0.5rem 0.5rem',\n        borderRadius: '0.1rem',\n        whiteSpace: 'pre-wrap'\n      }}>\n        {tooltipContent}\n      </div>;\n    }\n  }\n  return <></>;\n};\n","import { Props } from 'recharts/types/component/Label';\n\nexport const VotesLabel = ({ x, y, width, value } : Props) => {\n\n  if (typeof x !== 'number' ||\n    typeof y !== 'number' ||\n    typeof width !== 'number') {\n    return <></>;\n  }\n\n  return (\n    <text\n      x={x + width / 2}\n      y={y + width / 2}\n      width={width}\n      height={width}\n      fill='#fff'\n      textAnchor='middle'\n      fontSize='1.5rem'\n      dominantBaseline='middle'>\n      <tspan>\n        {value}\n      </tspan>\n    </text>\n  );\n};\n","import {\n  CartesianGrid,\n  LabelList,\n  ReferenceLine,\n  ResponsiveContainer,\n  Scatter,\n  ScatterChart,\n  Tooltip,\n  XAxis,\n  YAxis\n} from 'recharts';\nimport { Data, VotingStatus } from '../../../shared/model';\nimport {\n  useCreateMeanPoint,\n  useOnClickCallback,\n  useOnMouseMoveCallback,\n  usePoints,\n  useStyles\n} from './hooks';\nimport { axisTicks, domainLimits, mediumPoint } from './constants';\nimport { useUpdateState } from '../../../shared/hooks';\nimport { TooltipRenderer } from './TooltipRenderer';\nimport { VotesLabel } from './VotesLabel';\nimport { useTheme } from '@material-ui/core';\n\ninterface Props {\n  data: Data\n}\n\n/* Recharts does not allow custom component creation... \\_()_/ */\nexport const EffortValueChart = ({ data }: Props) => {\n\n  const theme = useTheme();\n  const points = usePoints(data);\n  const [suggestedPoint, onMouseMoveCallback] = useOnMouseMoveCallback();\n  const onClickCallback = useOnClickCallback(data);\n  useUpdateState([data.attendee?.vote]);\n  const styles = useStyles();\n  const createMeanPoint = useCreateMeanPoint();\n\n  return (\n    <ResponsiveContainer\n      aspect={1.6}\n      width='99%'\n      className={styles.responsiveContainer}>\n      <ScatterChart\n        margin={{\n          top: 40,\n          bottom: 40,\n          left: 40,\n          right: 40\n        }}\n        onMouseMove={onMouseMoveCallback}\n        onClick={onClickCallback}\n      >\n        <XAxis\n          dataKey='value'\n          type='number'\n          axisLine={false}\n          hide={false}\n          ticks={axisTicks}\n          domain={domainLimits}\n          stroke={theme.palette.primary.dark} />\n        <YAxis\n          dataKey='effort'\n          type='number'\n          axisLine={false}\n          hide={false}\n          ticks={axisTicks}\n          domain={domainLimits}\n          stroke={theme.palette.primary.dark} />\n        <ReferenceLine\n          x={mediumPoint}\n          stroke={theme.palette.primary.dark}\n          strokeWidth={2}\n          label={{\n            position: 'insideBottomLeft',\n            value: 'Effort',\n            fill: theme.palette.primary.dark\n          }}\n        />;\n        <ReferenceLine\n          y={mediumPoint}\n          stroke={theme.palette.primary.dark}\n          strokeWidth={2}\n          label={{\n            position: 'insideBottomLeft',\n            value: 'Value',\n            fill: theme.palette.primary.dark\n          }}\n        />\n        <CartesianGrid\n          strokeDasharray='2 4'\n          stroke={theme.palette.grey[400]} />\n        <Scatter\n          data={points}\n          isAnimationActive={false}\n          strokeOpacity={1}\n          strokeWidth={10}\n          fill=\"#fff\">\n          <LabelList\n            dataKey='label'\n            fontSize='4rem'\n            content={<VotesLabel />}\n          />\n        </Scatter>\n        {data.room?.votingStatus === VotingStatus.Open &&\n          suggestedPoint &&\n          <Scatter\n            data={[suggestedPoint]}\n            shape='cross'\n            rotate={200}\n            strokeWidth={12}\n            strokeOpacity={0.5}\n            fillOpacity={1}\n            fill={theme.palette.secondary.dark}>\n          </Scatter>}\n        {data.room?.votingStatus === VotingStatus.Closed &&\n          <Scatter\n            data={createMeanPoint(points)}\n            shape='cross'\n            rotate={200}\n            strokeWidth={12}\n            strokeOpacity={0.5}\n            fillOpacity={1}\n            fill={theme.palette.primary.dark}>\n          </Scatter>}\n        <Tooltip content={<TooltipRenderer points={points} />} />\n      </ScatterChart>\n    </ResponsiveContainer>\n  );\n};\n","import { useMemo } from 'react';\nimport { Data, VotingStatus } from '../../../../shared/model';\n\nexport const usePoints = (data: Data) => {\n  return useMemo(() => {\n    if (data.room?.attendees && data.user) {\n      if (data.room.votingStatus === VotingStatus.Open) {\n        const attendee = data.room?.findAttendeeByUser(data.user);\n        if (attendee?.vote) {\n          return [attendee.createChartPoint()];\n        }\n      } else {\n        return data.room\n          .attendees\n          .filter(attendee => attendee.vote)\n          .map(attendee => attendee.createChartPoint());\n      }\n    }\n    return [];\n  }, [data.room, data.user]);\n};\n","import { useCallback } from 'react';\nimport {\n  Attendee,\n  buildAttendeeVotedEvent,\n  ChartEventProps,\n  createVote,\n  Data,\n  VotingStatus\n} from '../../../../shared/model';\n\nexport const useOnClickCallback = (data: Data) => {\n  return useCallback((props: ChartEventProps) => {\n    if (props &&\n      data.user &&\n      data.room?.attendees &&\n      data.room.votingStatus === VotingStatus.Open) {\n      const { xValue, yValue } = props;\n      const vote = createVote(xValue, yValue);\n      const attendee = { ...data.attendee, vote } as Attendee;\n      data.subjects.$out.next(buildAttendeeVotedEvent(attendee));\n    }\n  }, [data]);\n};\n","import { useCallback } from 'react';\nimport { ChartPoint } from '../../../../shared/model';\n\nexport const useCreateMeanPoint = () => {\n  return useCallback((points: ChartPoint[]) => {\n    const initialValue = {\n      value: 0,\n      effort: 0,\n      label: 'Mean'\n    };\n    const mean = points.reduce((acc, point) => {\n      acc.effort += point.effort;\n      acc.value += point.value;\n\n      return acc;\n    }, initialValue);\n\n    mean.value /= points.length;\n    mean.effort /= points.length;\n\n    return [mean];\n  }, []);\n};\n","import { Grid } from '@material-ui/core';\nimport { useMemo } from 'react';\nimport { useUpdateState } from '../../shared/hooks';\nimport { Data } from '../../shared/model';\nimport { Attendees } from './attendees';\nimport { Controls } from './controls';\nimport { EffortValueChart } from './effort-value-chart';\nimport { useEventsCallback } from './hooks';\n\ninterface Params {\n  data: Data\n}\n\nexport const Room = ({ data }: Params) => {\n\n  useUpdateState([data.room]);\n  useEventsCallback(data);\n\n  const roomOwner = useMemo(() => {\n    if (data.room?.attendees && data.user) {\n      const userAttendee = data.room?.findAttendeeByUser(data.user);\n      return userAttendee?.roomOwner || false;\n    }\n    return false;\n  }, [data]);\n\n  return (\n    <Grid\n      container\n      direction='row'\n      spacing={1}>\n      <Grid\n        item\n        xs={9}>\n        <EffortValueChart data={data} />\n      </Grid>\n      <Grid\n        item\n        xs={3}>\n        <>\n          {\n            data.user &&\n            data.room &&\n            <Attendees\n              user={data.user}\n              room={data.room} />\n          }\n        </>\n      </Grid>\n      <Grid\n        item\n        xs={12}>\n        {roomOwner && <Controls data={data} />}\n      </Grid>\n    </Grid>\n  );\n};\n","import { useCallback, useEffect, useState } from 'react';\nimport { useParams } from 'react-router';\nimport { Subscription } from 'rxjs';\nimport {\n  buildCheckRoomExists,\n  buildJoinUserEvent,\n  CheckRoomExistsPayload,\n  Data,\n  Event,\n  EventType,\n  Room\n} from '../../../shared/model';\n\nexport const useEventsCallback = (data: Data) => {\n\n  const [eventsSubscription, setEventsSubscription] = useState<Subscription>();\n  const { roomId } = useParams<{ roomId: string }>();\n\n  const { connected, user, subjects } = data;\n  const eventsCallback = useCallback((event: Event) => {\n    if (event.type === EventType.CheckRoomExists) {\n      const payload = event.payload as CheckRoomExistsPayload;\n      if (user && payload && payload.exists) {\n        subjects.$out.next(buildJoinUserEvent(user, payload.room));\n      }\n    }\n  }, [user]);\n\n  useEffect(() => {\n    if (connected && user) {\n      eventsSubscription?.unsubscribe();\n      setEventsSubscription(subjects.$in.subscribe(eventsCallback));\n\n      subjects.$out.next(buildCheckRoomExists({\n        id: parseInt(roomId)\n      } as Room));\n      return () => eventsSubscription?.unsubscribe();\n    }\n  }, [connected, user, roomId]);\n};\n","import { Typography } from '@material-ui/core';\n\nexport const Title = () =>\n  <Typography\n    variant='h2'\n    align='center'\n    style={{\n      textDecoration: 'underline',\n      textShadow: '0px 0px 4px #888'\n    }}>\n    Pitanga\n  </Typography>;\n","import { Grid } from '@material-ui/core';\nimport { Switch, Route } from 'react-router-dom';\nimport { Container } from './container';\nimport { Home } from './home';\nimport { useSubscriptions, useDataState, useCheckAttendeeLeftRoomCallback } from './hooks';\nimport { Room } from './room';\nimport { Title } from './Title';\n\nexport function App() {\n\n  const dataState = useDataState();\n  useSubscriptions(dataState);\n  useCheckAttendeeLeftRoomCallback(dataState);\n  const [data] = dataState;\n\n  return (\n    <Container>\n      <Grid\n        container\n        direction='row'\n        spacing={1}>\n        <Grid\n          item\n          xs={12}>\n          <Title />\n        </Grid>\n        <Grid\n          item\n          xs={12}>\n          <Switch>\n            <Route path='/:roomId'>\n              <Room data={data} />\n            </Route>\n            <Route path='/'>\n              <Home\n                data={data} />\n            </Route>\n          </Switch>\n        </Grid>\n      </Grid>\n    </Container>\n  );\n}\n","import { useWebSocketSubjects } from './useWebSocketSubjects';\nimport { Data } from '../../shared/model';\nimport { useState } from 'react';\n\nexport const useDataState = () => {\n\n  const subjects = useWebSocketSubjects();\n\n  return useState<Data>({\n    connected: false,\n    subjects\n  });\n};\n","import { useHistory } from 'react-router-dom';\nimport { buildAttendeeLeftRoomEvent } from '../../shared/model';\nimport { Location, UnregisterCallback } from 'history';\nimport { DependencyList, useCallback, useState } from 'react';\nimport { CallbackHookParams } from './types';\n\ninterface UnregisterCallbackControl {\n  callback?: UnregisterCallback,\n  deps?: DependencyList\n}\n\nexport const useCheckAttendeeLeftRoomCallback = ([data]: CallbackHookParams) => {\n\n  const history = useHistory();\n\n  const deps: DependencyList = [data.room?.id, data.attendee];\n\n  const checkAttendeeLeftRoomCallback = useCallback((location: Location) => {\n    console.log(`[CB] Checking if user has left the room. Room id: ${data.room?.id}, pathname: ${location.pathname}`);\n    if (data.room?.id) {\n      if (!location.pathname.match(new RegExp(`/${data.room?.id}`))) {\n        console.log('[CB] Sending \"attendee-left-room\" event.');\n        data.attendee && data.subjects.$out.next(buildAttendeeLeftRoomEvent(data.attendee));\n      }\n    }\n  }, [data.room?.id, data.attendee]);\n\n  const [unregisterCallbackControl, setUnregisterCallbackControl] = useState<UnregisterCallbackControl>({});\n\n  if (!unregisterCallbackControl.callback) {\n    setUnregisterCallbackControl({\n      callback: history.listen(checkAttendeeLeftRoomCallback),\n      deps: deps\n    });\n  } else {\n    if (!unregisterCallbackControl.deps?.every((element, index) => element === deps[index])) {\n      unregisterCallbackControl.callback();\n      setUnregisterCallbackControl({\n        callback: history.listen(checkAttendeeLeftRoomCallback),\n        deps: deps\n      });\n    }\n  }\n};\n","import { render } from 'react-dom';\nimport { HashRouter } from 'react-router-dom';\nimport '@fontsource/roboto';\nimport { ThemeController } from './theme-controller';\nimport { App } from './app';\nimport { ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nrender(\n  /*\n    Github pages is not too friendly for single page applications. We have to use hash route to allow navigation.\n    Looking forward for this issue to be solved: https://github.com/isaacs/github/issues/408\n  */\n  <HashRouter>\n    <ThemeController>\n      <App />\n    </ThemeController>\n    <ToastContainer\n      position=\"bottom-right\" />\n  </HashRouter>,\n  document.getElementById('root')\n);\n","export * from './Room';\nexport * from './User';\nexport * from './events';\nexport * from './Attendee';\nexport * from './Data';\nexport * from './ChartEventProps';\nexport * from './ChartPoint';\nexport * from './Vote';\nexport * from './VotingStatus';\nexport * from './Toast';\n"],"sourceRoot":""}